<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pixel Ninja Cats — Mint</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Mint an on-chain pixel-art ninja kitty.">
    <link rel="icon" href="assets/detailed_ninja_cat_64.png">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Add GSAP for enhanced animations -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6/dist/ethers.umd.min.js"></script>

    <style>
        body {
            background: radial-gradient(ellipse at 60% 10%, #23263a 0%, #121212 100%);
            color: #e0e0e0;
            font-family: 'Poppins', sans-serif;
            min-height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            letter-spacing: 0.01em;
        }

        .wrapper {
            background: transparent;
            max-width: 980px;
            margin: 0 auto;
            padding-bottom: 40px;
            flex: 1 0 auto;
        }

        h1, h2, h3, h4 {
            color: #fff;
        }

        /* Navigation */
        nav {
            display: flex;
            align-items: center;
            background: #18181c;
            padding: 0.75rem 2rem;
            border-bottom: 1px solid #23233a;
            box-shadow: 0 2px 8px #8a65ff11;
            position: sticky;
            top: 0;
            z-index: 10;
            gap: 1.5rem;
        }

            nav img {
                width: 36px;
                height: 36px;
                border-radius: 8px;
                margin-right: 1rem;
                background: #23233a;
                box-shadow: 0 2px 8px #8a65ff22;
            }

            nav a {
                color: #a084ff;
                text-decoration: none;
                font-weight: 500;
                font-size: 1.08em;
                transition: color 0.2s;
                margin-right: 0.5rem;
                letter-spacing: 0.01em;
            }

                nav a:hover, nav a.active {
                    color: #ff9800;
                    text-shadow: 0 2px 8px #ff980055;
                }

            nav .spacer {
                flex: 1;
            }

        #connectBtn {
            background: linear-gradient(135deg, #8a65ff, #7067CF);
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 0.6rem 1.2rem;
            font-weight: 600;
            font-size: 1em;
            cursor: pointer;
            transition: background 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 8px #8a65ff22;
        }

            #connectBtn:hover {
                background: linear-gradient(135deg, #ff9800, #a084ff);
                color: #fff;
                box-shadow: 0 4px 16px #ff980044;
            }

        /* Price indicator in navigation */
        .price-indicator {
            background: rgba(34, 36, 58, 0.6);
            color: #a084ff;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.01em;
            border: 1px solid #3d3a5a;
            box-shadow: 0 2px 8px rgba(138, 101, 255, 0.15);
            display: flex;
            align-items: center;
        }

            .price-indicator #vtruPrice {
                color: #ff9800;
                font-weight: 700;
                margin: 0 0.3rem;
            }

        @media (max-width: 768px) {
            .price-indicator {
                margin: 0.5rem 0;
                font-size: 0.8rem;
                padding: 0.3rem 0.6rem;
            }
        }

        /* Hero Section */
        .hero {
            position: relative;
            padding: 3.2rem 1.5rem 2.5rem 1.5rem;
            margin-bottom: 2.5rem;
            text-align: center;
            background: linear-gradient(135deg, #23263a 0%, #18181c 100%);
            border-radius: 20px;
            box-shadow: 0 8px 32px #8a65ff22, 0 2px 12px #2775ca22;
            border: 1.5px solid #2d2d3a;
            overflow: hidden;
        }

            .hero h1 {
                margin-top: 1rem;
                text-shadow: 0 2px 12px #6e45e2a0;
                background: linear-gradient(135deg, #8a65ff, #2775ca 80%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                font-weight: 800;
                font-size: 2.8rem;
                letter-spacing: 0.04em;
                animation: fadeInDown 1s;
            }

            .hero h2 {
                color: #b0b0b0;
                margin-bottom: 1rem;
                font-weight: 500;
                font-size: 1.3rem;
            }

            .hero p {
                color: #b0b0b0;
                max-width: 700px;
                margin: 0 auto;
                font-size: 1.08rem;
            }

            .hero img {
                filter: drop-shadow(0 4px 16px #8a65ff55);
                width: 72px;
                height: 72px;
                border-radius: 16px;
                background: #23233a;
                margin-bottom: 0.5rem;
                box-shadow: 0 2px 12px #8a65ff33;
                animation: popIn 1.2s;
            }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }

            to {
                opacity: 1;
                transform: none;
            }
        }

        @keyframes popIn {
            0% {
                transform: scale(0.7);
                opacity: 0;
            }

            80% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Disclaimer */
        .disclaimer {
            background: linear-gradient(90deg, #23263a 0%, #181a20 100%);
            border-left: 4px solid #8a65ff;
            padding: 1.25rem;
            margin: 1.5rem 0;
            font-size: 0.98rem;
            border-radius: 10px;
            color: #b0b0b0;
            box-shadow: 0 4px 12px #8a65ff11;
            border: 1.5px solid #2d2d3a;
        }

            .disclaimer strong {
                color: #fff;
            }

        /* Breed Info */
        .breed-info {
            margin-top: 1rem;
            padding: 1.25rem;
            background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
            border-radius: 10px;
            display: none;
            border: 1.5px solid #2d2d3a;
            transition: all 0.3s;
        }

            .breed-info.active {
                display: block;
                animation: fadeIn 0.5s;
            }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: none;
            }
        }

        .breed-info h4 {
            color: #fff;
            margin-top: 0;
        }

        .breed-info p {
            color: #b0b0b0;
            margin-bottom: 0;
        }

        /* Card */
        .card {
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
            background: linear-gradient(120deg, #1e1e1e 80%, #23263a 100%);
            padding: 1.7rem 1.5rem 1.5rem 1.5rem;
            border-radius: 16px;
            box-shadow: 0 8px 32px #8a65ff22, 0 2px 12px #2775ca22;
            border: 1.5px solid #2d2d3a;
        }

            .card:hover {
                transform: translateY(-7px) scale(1.025);
                box-shadow: 0 16px 40px #8a65ff33, 0 0 25px #2775ca44;
                background: linear-gradient(120deg, #23263a 80%, #1e1e1e 100%);
            }

            .card label {
                color: #b0b0b0;
                margin-bottom: 0.5rem;
                display: block;
                font-weight: 500;
            }

            .card select {
                width: 100%;
                padding: 0.75rem;
                background: #23263a;
                border: 1.5px solid #444;
                border-radius: 8px;
                color: #fff;
                font-family: 'Poppins', sans-serif;
                margin-bottom: 1rem;
                font-size: 1.05em;
                transition: border 0.2s;
            }

                .card select:focus {
                    border: 1.5px solid #8a65ff;
                    outline: none;
                    box-shadow: 0 0 8px #8a65ff33;
                }

            .card .price {
                color: #8a65ff;
                font-weight: 700;
                font-size: 1.15rem;
                letter-spacing: 0.01em;
            }

        /* Mint Steps */
        .mint-steps {
            display: flex;
            justify-content: space-between;
            margin: 2.5rem 0;
            padding: 0;
            gap: 1.2rem;
        }

            .mint-steps li {
                flex: 1;
                list-style: none;
                text-align: center;
                padding: 1.25rem 0.75rem;
                background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
                margin: 0 0.5rem;
                border-radius: 10px;
                font-size: 1.02rem;
                color: #b0b0b0;
                border: 1.5px solid #2d2d3a;
                position: relative;
                font-weight: 500;
                box-shadow: 0 2px 8px #8a65ff11;
            }

                .mint-steps li strong {
                    color: #fff;
                    display: block;
                    margin-bottom: 0.5rem;
                    font-size: 1.2em;
                }

                .mint-steps li::after {
                    content: '';
                    position: absolute;
                    top: 50%;
                    right: -0.75rem;
                    width: 0.5rem;
                    height: 0.5rem;
                    border-top: 2px solid #8a65ff;
                    border-right: 2px solid #8a65ff;
                    transform: translateY(-50%) rotate(45deg);
                }

                .mint-steps li:last-child::after {
                    display: none;
                }

        /* Facts */
        .facts {
            margin-top: 2.5rem;
            padding: 1.5rem;
            background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
            border-radius: 14px;
            border: 1.5px solid #2d2d3a;
            box-shadow: 0 2px 8px #8a65ff11;
        }

            .facts h3 {
                margin-top: 0;
                margin-bottom: 1rem;
                color: #fff;
            }

            .facts ul {
                color: #b0b0b0;
                padding-left: 1.5rem;
            }

            .facts li {
                margin-bottom: 0.5rem;
                animation: fadeIn 0.5s;
            }

        /* Mint Button */
        #mintBtn {
            width: 100%;
            padding: 0.95rem;
            background: linear-gradient(135deg, #8a65ff, #2775ca);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1.15rem;
            cursor: pointer;
            transition: all 0.3s;
            margin: 1.2rem 0 0.5rem 0;
            box-shadow: 0 2px 8px #8a65ff22;
            letter-spacing: 0.01em;
            position: relative;
            z-index: 1;
        }

            #mintBtn:not([disabled]):hover {
                transform: translateY(-3px) scale(1.04);
                box-shadow: 0 8px 20px #8a65ff44;
                background: linear-gradient(135deg, #2775ca, #8a65ff);
            }

            #mintBtn[disabled] {
                background: #444;
                cursor: not-allowed;
                opacity: 0.7;
            }

        .breed-preview {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 150px;
            margin: 1.5rem 0;
            background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
            border-radius: 10px;
            font-style: italic;
            color: #9e9e9e;
            border: 1.5px dashed #8a65ff33;
            box-shadow: 0 1px 4px #8a65ff11;
        }

        /* Status */
        #status {
            padding: 0.75rem;
            text-align: center;
            border-radius: 8px;
            margin-top: 1rem;
            background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
            border: 1.5px solid #2d2d3a;
            display: none;
            color: #fff;
            font-weight: 500;
        }

        /* Mint Status */
        #mint-status {
            padding: 0.75rem;
            text-align: center;
            border-radius: 8px;
            margin-top: 1rem;
            display: none;
            color: #fff;
            font-weight: 500;
            border: 1.5px solid #2d2d3a;
        }

        .mint-status-pending {
            background: linear-gradient(120deg, rgba(255,152,0,0.1) 0%, rgba(255,193,7,0.07) 100%);
            border-color: rgba(255, 152, 0, 0.3);
        }

        .mint-status-processing {
            background: linear-gradient(120deg, rgba(138,101,255,0.1) 0%, rgba(39,117,202,0.07) 100%);
            border-color: rgba(138, 101, 255, 0.3);
        }

        .mint-status-completed {
            background: linear-gradient(120deg, rgba(74,222,128,0.1) 0%, rgba(34,197,94,0.07) 100%);
            border-color: rgba(74, 222, 128, 0.3);
            color: #4ade80;
        }

        .mint-status-failed {
            background: linear-gradient(120deg, rgba(239,68,68,0.1) 0%, rgba(220,38,38,0.07) 100%);
            border-color: rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        .mint-status-timeout {
            background: linear-gradient(120deg, rgba(255,152,0,0.1) 0%, rgba(255,193,7,0.07) 100%);
            border-color: rgba(255, 152, 0, 0.3);
            color: #ff9800;
        }

        .mint-status-default {
            background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
            border-color: #2d2d3a;
        }

        /* Spinner */
        .spinner {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 3px solid rgba(255,255,255,0.2);
            border-radius: 50%;
            border-top-color: #8a65ff;
            animation: spin 1s linear infinite;
            vertical-align: middle;
            margin-right: 0.5rem;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* NFT Showcase Carousel */
        .nft-showcase {
            margin-top: 3rem;
            padding: 1.5rem;
            background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
            border-radius: 16px;
            border: 1.5px solid #2d2d3a;
            box-shadow: 0 4px 12px #8a65ff22;
        }

            .nft-showcase h3 {
                text-align: center;
                margin-bottom: 1.5rem;
                color: #fff;
                letter-spacing: 0.01em;
            }

        .carousel-container {
            position: relative;
            overflow: hidden;
            border-radius: 14px;
            height: 300px;
            margin-bottom: 1rem;
            background: #18181c;
            box-shadow: 0 2px 8px #8a65ff11;
        }

        .carousel-track {
            display: flex;
            transition: transform 0.5s cubic-bezier(.4,2,.6,1);
            height: 100%;
        }

        .carousel-item {
            min-width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .carousel-image {
            max-height: 200px;
            border-radius: 10px;
            box-shadow: 0 4px 16px #8a65ff33;
            border: 1.5px solid #2d2d3a;
            background: #18181c;
        }

        .carousel-caption {
            margin-top: 1rem;
            text-align: center;
            color: #e0e0e0;
            font-size: 1.08rem;
            letter-spacing: 0.01em;
        }

        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.6);
            border: none;
            color: white;
            border-radius: 50%;
            font-size: 1.5rem;
            line-height: 1;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s;
            z-index: 2;
        }

            .carousel-nav:hover {
                opacity: 1;
                background: linear-gradient(135deg, #8a65ff, #2775ca);
                color: #fff;
            }

            .carousel-nav.prev {
                left: 10px;
            }

            .carousel-nav.next {
                right: 10px;
            }

        .carousel-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 1rem;
        }

        .carousel-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #444;
            cursor: pointer;
            transition: background 0.3s;
        }

            .carousel-dot.active {
                background: #8a65ff;
                box-shadow: 0 2px 8px #8a65ff44;
            }

        /* Provider Info */
        .provider-info {
            margin-top: 1rem;
            padding: 1.25rem;
            background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
            border-radius: 10px;
            display: none;
            border: 1.5px solid #2d2d3a;
            transition: all 0.3s;
        }

            .provider-info.active {
                display: block;
                animation: fadeIn 0.5s;
            }

        /* New styles for the prompt inputs and advanced options */
        textarea.prompt-input {
            width: 100%;
            padding: 0.75rem;
            background: #23263a;
            border: 1.5px solid #444;
            border-radius: 8px;
            color: #fff;
            font-family: 'Poppins', sans-serif;
            margin-bottom: 1rem;
            font-size: 1em;
            transition: border 0.2s;
            resize: vertical;
            min-height: 80px;
        }

            textarea.prompt-input:focus {
                border: 1.5px solid #8a65ff;
                outline: none;
                box-shadow: 0 0 8px #8a65ff33;
            }

        .advanced-toggle {
            background: transparent;
            border: none;
            color: #a084ff;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-weight: 500;
            padding: 0.5rem;
            margin: 0.5rem 0;
            width: 100%;
            justify-content: space-between;
            border-radius: 8px;
            transition: background 0.2s;
        }

            .advanced-toggle:hover {
                background: rgba(138,101,255,0.1);
            }

            .advanced-toggle::after {
                content: '▼';
                font-size: 0.8em;
                margin-left: 0.5rem;
                transition: transform 0.3s;
            }

            .advanced-toggle.active::after {
                transform: rotate(180deg);
            }

        .advanced-options {
            display: none;
            padding: 1rem;
            background: rgba(35, 38, 58, 0.3);
            border-radius: 8px;
            margin-bottom: 1rem;
            border: 1px solid #2d2d3a;
        }

            .advanced-options.show {
                display: block;
                animation: fadeIn 0.5s;
            }

        .provider-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 0.5rem;
        }

        .provider-option {
            min-width: 160px;
            flex: 1;
        }

        .option-group {
            margin-bottom: 1rem;
        }

        .option-label {
            display: block;
            margin-bottom: 0.3rem;
            font-size: 0.9em;
            color: #b0b0b0;
        }

        .provider-pros-cons {
            display: flex;
            gap: 20px;
            margin: 15px 0;
        }

        .pros, .cons {
            flex: 1;
        }

            .pros h5 {
                margin: 5px 0;
                color: #16a34a;
            }

            .cons h5 {
                margin: 5px 0;
                color: #dc2626;
            }

            .pros ul, .cons ul {
                margin: 0;
                padding-left: 20px;
            }

        /* Progress bar */
        .progress-container {
            width: 100%;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin: 15px 0;
            overflow: hidden;
            display: none;
        }

        .progress-bar {
            height: 10px;
            background: linear-gradient(90deg, #8a65ff, #2775ca);
            border-radius: 8px;
            width: 0%;
            transition: width 0.3s ease-in-out;
        }

        /* Download section styles */
        .download-section {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(120deg, rgba(138,101,255,0.1) 0%, rgba(39,117,202,0.07) 100%);
            border-radius: 10px;
            border: 1.5px solid #2d2d3a;
            display: none;
            animation: fadeIn 0.5s;
        }

            .download-section h4 {
                margin-top: 0;
                margin-bottom: 10px;
                color: #fff;
            }

        .download-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .download-btn {
            flex: 1;
            min-width: 150px;
            padding: 10px 15px;
            background: linear-gradient(135deg, #8a65ff, #2775ca);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

            .download-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 4px 12px rgba(138,101,255,0.3);
                background: linear-gradient(135deg, #2775ca, #8a65ff);
            }

            .download-btn svg {
                margin-right: 8px;
                width: 16px;
                height: 16px;
            }

        /* Provider icons */
        .provider-icons {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            justify-content: center;
        }

        .provider-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: #23263a;
            border: 1.5px solid #444;
            color: #b0b0b0;
            cursor: pointer;
            transition: all 0.2s ease;
        }

            .provider-icon:hover {
                border-color: #8a65ff;
                transform: translateY(-3px);
                box-shadow: 0 4px 12px rgba(138, 101, 255, 0.2);
            }

            .provider-icon.active {
                background: linear-gradient(135deg, rgba(138, 101, 255, 0.2), rgba(39, 117, 202, 0.2));
                border-color: #8a65ff;
                color: white;
                box-shadow: 0 4px 12px rgba(138, 101, 255, 0.3);
            }

        /* Tooltip styles */
        .tooltip {
            position: absolute;
            background: rgba(35, 38, 58, 0.95);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9em;
            pointer-events: none;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s, transform 0.3s;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            max-width: 250px;
            text-align: center;
        }

            .tooltip.visible {
                opacity: 1;
                transform: translateY(0);
            }

        /* Success animation styles */
        .success-ui {
            display: flex;
            align-items: center;
            flex-direction: column;
            text-align: center;
        }

        .checkmark-circle {
            stroke-dasharray: 157;
            stroke-dashoffset: 157;
            stroke: #4ade80;
            transform-origin: 50% 50%;
            fill: none;
        }

        .checkmark-check {
            stroke-dasharray: 32;
            stroke-dashoffset: 32;
            stroke: #4ade80;
            stroke-width: 4;
            stroke-linecap: round;
            transform-origin: 50% 50%;
        }

        .success-content {
            margin-top: 15px;
            opacity: 0;
        }

        .explorer-link {
            color: #8a65ff;
            text-decoration: underline;
            margin-top: 8px;
            display: inline-block;
        }

        .view-nft-btn {
            display: block;
            background: linear-gradient(135deg, #8a65ff, #2775ca);
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 8px;
            margin-top: 15px;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(138,101,255,0.2);
            transition: all 0.3s ease;
        }

        /* Transaction animation */
        .tx-confirmation {
            display: flex;
            align-items: center;
            background: linear-gradient(120deg, rgba(138,101,255,0.1) 0%, rgba(39,117,202,0.07) 100%);
            padding: 15px;
            border-radius: 10px;
            border: 1.5px solid rgba(45, 45, 58, 0.8);
        }

        .tx-animation {
            position: relative;
            width: 48px;
            height: 48px;
            margin-right: 15px;
        }

        .tx-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 3px solid rgba(138, 101, 255, 0.5);
            border-top: 3px solid #8a65ff;
            border-radius: 50%;
        }

        .tx-pulse {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 3px solid rgba(138, 101, 255, 0.3);
            border-radius: 50%;
        }

        .tx-hash {
            font-size: 0.85em;
            margin-top: 8px;
            background: rgba(0,0,0,0.2);
            padding: 4px 8px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

            .tx-hash a {
                color: #8a65ff;
            }

        /* Generation animation */
        .nft-generation {
            padding: 15px;
            border-radius: 10px;
            border: 1.5px solid rgba(45, 45, 58, 0.8);
            background: linear-gradient(120deg, rgba(138,101,255,0.1) 0%, rgba(39,117,202,0.07) 100%);
        }

        .generation-container {
            display: flex;
            align-items: center;
        }

        .generation-animation {
            position: relative;
            width: 80px;
            height: 80px;
            margin-right: 15px;
        }

        .generation-circle {
            stroke: #8a65ff;
            stroke-width: 4;
            stroke-linecap: round;
            fill: none;
            stroke-dasharray: 251.2;
            stroke-dashoffset: 251.2;
        }

        .generation-path {
            stroke: #ff9800;
            stroke-width: 4;
            stroke-linecap: round;
            fill: none;
        }

        .generation-stages {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 12px;
        }

        .generation-stage {
            background: rgba(255,255,255,0.1);
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 0.9em;
            opacity: 0.6;
            transition: all 0.3s ease;
        }

            .generation-stage.active {
                background: rgba(138,101,255,0.1);
                color: #8a65ff;
                opacity: 1;
            }

        /* Mint button particle effect */
        .particle-container {
            position: relative;
            width: 100%;
            height: 60px;
            overflow: hidden;
            border-radius: 10px;
        }

        .mint-particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: linear-gradient(135deg, #8a65ff, #2775ca);
            border-radius: 50%;
            opacity: 0.3;
            animation: float-up 5s ease-in-out infinite;
        }

        @keyframes float-up {
            0% {
                transform: translateY(60px) rotate(0deg);
                opacity: 0;
            }

            20% {
                opacity: 0.3;
            }

            80% {
                opacity: 0.3;
            }

            100% {
                transform: translateY(-20px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Error UI */
        .error-ui {
            display: flex;
            align-items: center;
            background: linear-gradient(120deg, rgba(239,68,68,0.1) 0%, rgba(127,29,29,0.07) 100%);
            padding: 15px;
            border-radius: 10px;
            border: 1.5px solid rgba(220, 38, 38, 0.3);
        }

        .error-icon {
            margin-right: 15px;
        }

        .retry-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            margin-top: 10px;
            cursor: pointer;
            font-family: inherit;
            font-weight: 500;
        }

        /* Timeout UI */
        .timeout-ui {
            display: flex;
            align-items: center;
            background: linear-gradient(120deg, rgba(255,152,0,0.1) 0%, rgba(255,193,7,0.07) 100%);
            padding: 15px;
            border-radius: 10px;
            border: 1.5px solid rgba(255, 152, 0, 0.3);
        }

        .timeout-icon {
            margin-right: 15px;
        }

        .timeout-content {
            flex: 1;
        }

        .timeout-content h4 {
            margin: 0 0 8px 0;
            color: #ff9800;
        }

        .timeout-content p {
            margin: 0 0 10px 0;
            color: #b0b0b0;
        }

        /* Breed Preview (simplified) */
        .breed-preview {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 150px;
            margin: 1.5rem 0;
            background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
            border-radius: 10px;
            font-style: italic;
            color: #9e9e9e;
            border: 1.5px dashed #8a65ff33;
            box-shadow: 0 1px 4px #8a65ff11;
        }

        .preview-placeholder {
            text-align: center;
            color: #9e9e9e;
            padding: 20px;
        }

        /* Enhanced Progress Timeline */
        .task-progress-timeline {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(120deg, rgba(138,101,255,0.07) 0%, rgba(39,117,202,0.04) 100%);
            border-radius: 16px;
            border: 1.5px solid #2d2d3a;
        }

        .timeline-stage {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            border: 1px solid #2d2d3a;
            transition: all 0.3s ease;
            position: relative;
        }

        .timeline-stage.active {
            background: rgba(138,101,255,0.1);
            border-color: rgba(138,101,255,0.3);
            box-shadow: 0 4px 12px rgba(138,101,255,0.2);
        }

        .timeline-stage.completed {
            background: rgba(74,222,128,0.1);
            border-color: rgba(74,222,128,0.3);
        }

        .timeline-stage.failed {
            background: rgba(239,68,68,0.1);
            border-color: rgba(239,68,68,0.3);
        }

        .stage-icon {
            font-size: 1.5em;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(138,101,255,0.1);
            border-radius: 50%;
            border: 2px solid #2d2d3a;
            transition: all 0.3s ease;
        }

        .timeline-stage.active .stage-icon {
            background: rgba(138,101,255,0.2);
            border-color: rgba(138,101,255,0.5);
            animation: pulse 2s infinite;
        }

        .timeline-stage.completed .stage-icon {
            background: rgba(74,222,128,0.2);
            border-color: rgba(74,222,128,0.5);
        }

        .timeline-stage.failed .stage-icon {
            background: rgba(239,68,68,0.2);
            border-color: rgba(239,68,68,0.5);
        }

        .stage-label {
            font-weight: 600;
            color: #fff;
            flex: 1;
            font-size: 1.1em;
        }

        .stage-status {
            color: #9e9e9e;
            font-size: 0.9em;
            font-style: italic;
        }

        .timeline-stage.active .stage-status {
            color: #8a65ff;
        }

        .timeline-stage.completed .stage-status {
            color: #4ade80;
        }

        .timeline-stage.failed .stage-status {
            color: #ef4444;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Enhanced Sharing Section */
        .sharing-section {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            border: 1px solid #2d2d3a;
        }

        .sharing-section h5 {
            color: #fff;
            margin: 0 0 10px 0;
            font-size: 1.1em;
        }

        .sharing-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .share-btn {
            flex: 1;
            min-width: 120px;
            padding: 10px 15px;
            background: linear-gradient(135deg, #8a65ff, #2775ca);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(138,101,255,0.3);
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(138,101,255,0.4);
        }

        .share-btn.twitter {
            background: linear-gradient(135deg, #1DA1F2, #0d8bd9);
        }

        .share-btn.twitter:hover {
            box-shadow: 0 6px 16px rgba(29,161,242,0.4);
        }

        /* Enhanced Mobile Responsiveness */
        @media (max-width: 480px) {
            .task-progress-timeline {
                padding: 15px;
                gap: 10px;
            }

            .timeline-stage {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }

            .stage-label {
                font-size: 1em;
            }

            .sharing-buttons {
                flex-direction: column;
            }

            .share-btn {
                min-width: 100%;
            }

            .download-buttons {
                flex-direction: column;
            }

            .download-btn {
                min-width: 100%;
                margin-bottom: 10px;
            }

            /* Enhanced mint button for mobile */
            #mintBtn {
                font-size: 1.2rem;
                padding: 1.2rem;
                border-radius: 12px;
            }

            /* Advanced settings drawer for mobile */
            .advanced-options {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.9);
                z-index: 1000;
                padding: 20px;
                overflow-y: auto;
                transform: translateY(100%);
                transition: transform 0.3s ease;
            }

            .advanced-options.show {
                transform: translateY(0);
            }

            .advanced-options::before {
                content: "Advanced Options";
                display: block;
                font-size: 1.5em;
                font-weight: 600;
                color: #fff;
                text-align: center;
                margin-bottom: 20px;
                padding-bottom: 15px;
                border-bottom: 2px solid #8a65ff;
            }

            .advanced-options .close-drawer {
                position: absolute;
                top: 15px;
                right: 15px;
                background: none;
                border: none;
                color: #fff;
                font-size: 1.5em;
                cursor: pointer;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                background: rgba(255,255,255,0.1);
            }
        }

        /* Toast notifications */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            min-width: 250px;
            padding: 12px 16px;
            border-radius: 8px;
            background: #333;
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            overflow: hidden;
            transform: translateX(100%);
            opacity: 0;
        }

            .toast.show {
                animation: toast-in 0.3s forwards, toast-out 0.3s forwards;
                animation-delay: 0s, 2.7s;
            }

            .toast.info {
                background: #3498db;
            }

            .toast.success {
                background: linear-gradient(135deg, #8a65ff, #2775ca);
            }

            .toast.warning {
                background: #f39c12;
            }

            .toast.error {
                background: #e74c3c;
            }

        @keyframes toast-in {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes toast-out {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* Approval animation */
        .approval-ui {
            display: flex;
            align-items: center;
            padding: 15px;
            border-radius: 10px;
        }

        .approval-animation {
            margin-right: 15px;
        }

        .approval-svg {
            transform: rotate(-90deg);
        }

        .approval-path {
            stroke-dasharray: 75;
            stroke-dashoffset: 75;
        }

        .checkmark-path {
            stroke-dasharray: 15;
            stroke-dashoffset: 15;
        }

        /* Responsive adjustments */
        @media (max-width: 1100px) {
            .wrapper {
                padding-left: 4vw;
                padding-right: 4vw;
            }
        }

        @media (max-width: 900px) {
            .wrapper {
                max-width: 100%;
                padding-left: 2vw;
                padding-right: 2vw;
            }

            nav {
                flex-wrap: wrap;
                padding: 0.75rem 1rem;
            }
        }

        @media (max-width: 768px) {
            .mint-steps {
                flex-direction: column;
                gap: 1rem;
            }

                .mint-steps li {
                    margin: 0;
                }

                    .mint-steps li::after {
                        right: 50%;
                        top: auto;
                        bottom: -0.75rem;
                        transform: translateX(50%) rotate(135deg);
                    }

            .carousel-container {
                height: 220px;
            }

            .hero h1 {
                font-size: 1.7rem;
            }
        }

        @media (max-width: 480px) {
            .wrapper {
                padding-left: 1vw;
                padding-right: 1vw;
            }

            .hero {
                padding: 1.5rem 0.5rem;
            }

            .card {
                padding: 1rem 0.5rem;
            }

            .facts {
                padding: 1rem 0.5rem;
            }
        }

        /* ─── Footer Styles ─── */
        footer {
            flex-shrink: 0;
            background: #18181c;
            color: #b0b0b0;
            text-align: center;
            padding: 0;
            border-top: 2px solid #8a65ff;
            margin-top: 40px;
            letter-spacing: 0.02em;
            box-shadow: 0 -2px 8px #8a65ff11;
        }

        .footer-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 32px 32px 18px 32px;
            box-sizing: border-box;
        }

        @media (max-width: 1100px) {
            .footer-container {
                padding: 32px 8vw 18px 8vw;
            }
        }

        @media (max-width: 900px) {
            .footer-container {
                max-width: 100%;
                padding: 24px 4vw 12px 4vw;
            }
        }

        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 32px;
            text-align: left;
        }

        .footer-section {
            flex: 1 1 180px;
            min-width: 160px;
            margin-bottom: 24px;
        }

        @media (max-width: 700px) {
            .footer-content {
                flex-direction: column;
                gap: 0;
            }

            .footer-section {
                min-width: 0;
            }
        }

        .footer-logo {
            width: 40px;
            height: 40px;
            object-fit: contain;
            border-radius: 8px;
            background: #22243a;
            margin-bottom: 8px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 2px 8px #8a65ff15;
        }

        .footer-links {
            list-style: none;
            padding: 0;
            margin: 0;
        }

            .footer-links li {
                margin-bottom: 8px;
            }

            .footer-links a {
                color: #a084ff;
                text-decoration: none;
                font-size: 1em;
                transition: color 0.2s;
            }

                .footer-links a:hover {
                    color: #ff9800;
                    text-decoration: underline;
                }

        .social-links {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-top: 8px;
        }

        .social-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #22243a;
            color: #a084ff;
            transition: background 0.2s, color 0.2s;
            font-size: 1.2em;
            box-shadow: 0 2px 8px #8a65ff11;
        }

            .social-icon:hover {
                background: #a084ff;
                color: #fff;
            }

        .footer-disclaimer {
            margin: 24px 0 8px 0;
            font-size: 0.95em;
            color: #b0b0b0;
            background: #201c2a;
            border-left: 4px solid #ff9800;
            padding: 12px 18px;
            border-radius: 4px;
        }

        .footer-copyright {
            font-size: 0.95em;
            color: #b0b0b0;
            margin-bottom: 0;
            margin-top: 8px;
            letter-spacing: 0.01em;
        }

        /* VTRU conversion display - matching marketplace style */
        .vtru-conversion {
            color: #a084ff;
            font-size: 0.9rem;
            margin-top: 0.2rem;
            opacity: 0.8;
            font-style: italic;
        }

        /* Enhanced Error UI with Animated Emojis */
        .error-ui {
            display: flex;
            align-items: center;
            background: linear-gradient(120deg, rgba(239,68,68,0.1) 0%, rgba(127,29,29,0.07) 100%);
            padding: 20px;
            border-radius: 16px;
            border: 1.5px solid rgba(220, 38, 38, 0.3);
            box-shadow: 0 4px 16px rgba(239,68,68,0.2);
        }

        .error-icon {
            margin-right: 20px;
            font-size: 3em;
            animation: errorBounce 0.6s ease-in-out;
        }

        .error-emoji {
            font-size: 2.5em;
            margin-right: 15px;
            animation: emojiWobble 2s ease-in-out infinite;
        }

        @keyframes errorBounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes emojiWobble {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        /* Enhanced Success Animation */
        .success-ui {
            display: flex;
            align-items: center;
            flex-direction: column;
            text-align: center;
            background: linear-gradient(120deg, rgba(74,222,128,0.1) 0%, rgba(34,197,94,0.07) 100%);
            padding: 25px;
            border-radius: 16px;
            border: 1.5px solid rgba(74,222,128,0.3);
            box-shadow: 0 4px 16px rgba(74,222,128,0.2);
        }

        .success-emoji {
            font-size: 3em;
            margin-bottom: 15px;
            animation: successCelebration 1s ease-in-out;
        }

        @keyframes successCelebration {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
            100% { transform: scale(1) rotate(360deg); opacity: 1; }
        }

        .retry-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            margin-top: 15px;
            cursor: pointer;
            font-family: inherit;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .retry-btn:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        /* Enhanced Particle Effects */
        .charge-particle {
            position: absolute;
            width: 12px;
            height: 12px;
            background: linear-gradient(135deg, #ff9800, #f57c00);
            border-radius: 50%;
            opacity: 0.6;
            animation: chargeUp 2s ease-in-out infinite;
        }

        @keyframes chargeUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 0.6;
            }
            50% {
                transform: translateY(-30px) scale(1.5);
                opacity: 1;
            }
            100% {
                transform: translateY(-60px) scale(0.5);
                opacity: 0;
            }
        }

        .timeout-emoji {
            font-size: 2.5em;
            margin-right: 15px;
            animation: emojiFloat 3s ease-in-out infinite;
        }

        @keyframes emojiFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        /* Price shimmer effect */
        .price-shimmer {
            display: inline-block;
            width: 80px;
            height: 20px;
            background: linear-gradient(90deg, #3a3a3a 25%, #4a4a4a 50%, #3a3a3a 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: 4px;
            vertical-align: middle;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .price-value {
            font-weight: 700;
            color: #8a65ff;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        /* Mobile drawer enhancements */
        @media (max-width: 480px) {
            .advanced-toggle {
                background: linear-gradient(135deg, #8a65ff, #2775ca);
                color: white;
                border: none;
                border-radius: 8px;
                padding: 12px 20px;
                font-weight: 600;
                cursor: pointer;
                width: 100%;
                margin: 10px 0;
                position: relative;
                overflow: hidden;
            }

            .advanced-toggle::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
                transition: left 0.5s;
            }

            .advanced-toggle:hover::before {
                left: 100%;
            }

            .advanced-toggle::after {
                content: '⚙️';
                margin-left: 10px;
                font-size: 1.2em;
            }

            .advanced-options {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
                z-index: 1000;
                padding: 20px;
                overflow-y: auto;
                transform: translateY(100%);
                transition: transform 0.3s ease;
                border: none;
                border-radius: 0;
            }

            .advanced-options.show {
                transform: translateY(0);
            }

            .advanced-options::before {
                content: "⚙️ Advanced Options";
                display: block;
                font-size: 1.5em;
                font-weight: 600;
                color: #fff;
                text-align: center;
                margin-bottom: 20px;
                padding-bottom: 15px;
                border-bottom: 2px solid #8a65ff;
            }

            .advanced-options .close-drawer {
                position: absolute;
                top: 15px;
                right: 15px;
                background: rgba(255,255,255,0.1);
                border: none;
                color: #fff;
                font-size: 1.5em;
                cursor: pointer;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                transition: all 0.3s ease;
            }

            .advanced-options .close-drawer:hover {
                background: rgba(255,255,255,0.2);
                transform: scale(1.1);
            }

            .advanced-options .close-drawer::before {
                content: '✕';
            }
        }
    </style>
</head>
<head>

</head>

<body>
    <!-- Navbar will be added by navbar.js -->
    <div id="navbar-container"></div>

    <div class="wrapper">
        <!-- HERO -->
        <header class="hero">
            <img src="assets/detailed_ninja_cat_64.png" class="pixel" alt="">
            <h1>Pixel Ninja Cats</h1>
            <h2>Summon your stealthy on-chain companion</h2>
            <p>Each Ninja Cat is uniquely generated on-chain with its own special attributes, colors, and ninja abilities.</p>
        </header>

        <!-- NFT Showcase Carousel -->
        <section class="nft-showcase">
            <h3>Recently Minted Ninjas</h3>
            <div class="carousel-container">
                <div class="carousel-track" id="nftCarousel">
                    <!-- NFT cards will be inserted here dynamically -->
                    <div class="carousel-item">
                        <div class="spinner"></div>
                        <p>Loading ninja cats...</p>
                    </div>
                </div>
                <button class="carousel-nav prev" id="prevBtn">❮</button>
                <button class="carousel-nav next" id="nextBtn">❯</button>
            </div>
            <div class="carousel-dots" id="carouselDots">
                <!-- Dots will be inserted here dynamically -->
            </div>
        </section>

        <div class="disclaimer">
            <strong>AI Generation Notice:</strong> All Pixel Ninja Cat imagery is completely randomly generated using advanced AI models. Each NFT is unique and algorithmically created at the moment of minting, making your ninja cat truly one-of-a-kind.
        </div>

        <!-- MINT STEPS -->
        <ul class="mint-steps">
            <li><strong>1</strong> Choose your breed</li>
            <li><strong>2</strong> Connect your wallet</li>
            <li><strong>3</strong> Mint your unique ninja cat</li>
        </ul>

        <!-- MINT CARD -->
        <section class="card">
            <label for="breed">Choose your cat's breed</label>
            <select id="breed">
                <option value="Bengal">Bengal</option>
                <option value="Siamese">Siamese</option>
                <option value="Maine Coon">Maine Coon</option>
                <option value="Calico">Calico</option>
                <option value="Sphynx">Sphynx</option>
                <option value="Shadow">Shadow</option>
                <option value="Nyan">Nyan</option>
                <option value="Persian">Persian</option>
                <option value="Bombay">Bombay</option>
                <option value="Tabby">Tabby</option>
            </select>

            <!-- Add AI Provider Selection -->
            <label for="imageProvider">Choose AI image provider</label>
            <select id="imageProvider" data-tooltip="Select which AI service will generate your cat's image">
                <option value="dall-e">DALL-E 3 (OpenAI)</option>
                <option value="stability">Stability AI (SDXL)</option>
                <option value="huggingface">HuggingFace (Free)</option>
            </select>

            <!-- Custom Prompt Input -->
            <label for="promptExtras">Custom prompt details (optional)</label>
            <textarea id="promptExtras" class="prompt-input" placeholder="Add specific details you want to see in your ninja cat (e.g., 'with glowing eyes, golden armor')"></textarea>

            <!-- Advanced Options Toggle -->
            <button class="advanced-toggle" id="advancedToggle">Advanced Options</button>

            <!-- Advanced Options Section -->
            <div class="advanced-options" id="advancedOptions">
                <!-- Negative Prompt -->
                <div class="option-group">
                    <label for="negativePrompt" class="option-label">Negative prompt (elements to avoid)</label>
                    <textarea id="negativePrompt" class="prompt-input" placeholder="Specify what you don't want in the image (e.g., 'text, watermark, blurry, distorted')" style="min-height: 60px;">text, watermark, signature, borders, low quality, blurry, distorted</textarea>
                </div>

                <!-- Provider-specific options containers -->
                <div class="provider-options-container">
                    <!-- Provider option panels will be created dynamically by JavaScript -->
                </div>
            </div>

            <div class="breed-preview">
                <div class="preview-placeholder">
                    <p>Select traits to see preview</p>
                </div>
            </div>

            <!-- Add info sections for each provider -->
            <div id="dall-e-info" class="provider-info active">
                <h4>DALL-E 3</h4>
                <p>OpenAI's most advanced image generation model. Creates highly detailed pixel ninja cats with excellent composition and character design.</p>
                <div class="provider-pros-cons">
                    <div class="pros">
                        <h5>Pros</h5>
                        <ul>
                            <li>High quality images</li>
                            <li>Best text comprehension</li>
                            <li>Consistent style</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h5>Cons</h5>
                        <ul>
                            <li>May be slower</li>
                            <li>Higher cost</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div id="huggingface-info" class="provider-info">
                <h4>Stable Diffusion (HuggingFace)</h4>
                <p>Free open-source model that creates quality ninja cat pixel art. May have more artistic variation but produces unique stylized results.</p>
                <div class="provider-pros-cons">
                    <div class="pros">
                        <h5>Pros</h5>
                        <ul>
                            <li>Free to use</li>
                            <li>Multiple model options</li>
                            <li>Community supported</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h5>Cons</h5>
                        <ul>
                            <li>Quality may vary</li>
                            <li>Can be slower</li>
                            <li>May require loading time</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div id="stability-info" class="provider-info">
                <h4>Stability AI</h4>
                <p>Creators of Stable Diffusion with professional image quality. Excellent for detailed ninja cat pixel art with consistent style and composition.</p>
                <div class="provider-pros-cons">
                    <div class="pros">
                        <h5>Pros</h5>
                        <ul>
                            <li>Great stylization</li>
                            <li>Good fine details</li>
                            <li>Style control</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h5>Cons</h5>
                        <ul>
                            <li>May need more specific prompts</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Breed Information Cards -->
            <div id="bengal-info" class="breed-info active">
                <h4>Bengal Ninja</h4>
                <p>The stealthy Bengal ninjas are known for their spotted patterns and exceptional agility. They excel at infiltration missions and can leap across great distances silently.</p>
            </div>

            <div id="siamese-info" class="breed-info">
                <h4>Siamese Ninja</h4>
                <p>Masters of psychological warfare, Siamese ninjas use their hypnotic blue eyes and distinctive voice to confuse enemies. They're especially skilled at night operations.</p>
            </div>

            <div id="mainecoon-info" class="breed-info">
                <h4>Maine Coon Ninja</h4>
                <p>The largest of ninja cats, Maine Coons combine raw power with unexpected stealth. Their thick fur allows them to operate in harsh conditions, and they're renowned for their loyalty.</p>
            </div>

            <div id="calico-info" class="breed-info">
                <h4>Calico Ninja</h4>
                <p>With their multi-colored coats, Calico ninjas are masters of disguise and deception. They're believed to bring good fortune to their allies and misfortune to their enemies.</p>
            </div>

            <div id="sphynx-info" class="breed-info">
                <h4>Sphynx Ninja</h4>
                <p>The enigmatic hairless Sphynx ninjas are immune to detection by conventional means. Their unique appearance conceals their true power - an unmatched sensitivity to energy flows.</p>
            </div>

            <div id="shadow-info" class="breed-info">
                <h4>Shadow Ninja</h4>
                <p>Legendary and rarely seen, Shadow ninjas are born of void energies. They can merge with darkness completely, making them the ultimate assassins and spies in the Ninja Cat world.</p>
            </div>

            <div id="nyan-info" class="breed-info">
                <h4>Nyan Ninja</h4>
                <p>The cosmic Nyan ninjas trail rainbow energy as they move. These legendary warriors possess playful yet devastating power, channeling the cosmic forces of the multiverse.</p>
            </div>

            <div id="persian-info" class="breed-info">
                <h4>Persian Ninja</h4>
                <p>With their luxurious coats and regal demeanor, Persian ninjas are tactical masterminds. They appear slow and docile but possess unmatched intelligence and strategic prowess.</p>
            </div>

            <div id="bombay-info" class="breed-info">
                <h4>Bombay Ninja</h4>
                <p>These sleek black ninjas are nearly invisible in darkness. Bombay ninjas are considered to be blessed by the night itself, with unparalleled stealth capabilities.</p>
            </div>

            <div id="tabby-info" class="breed-info">
                <h4>Tabby Ninja</h4>
                <p>The most adaptable of all ninja cats, Tabby warriors are versatile fighters. Their distinctive stripes are said to represent the paths of fate they can navigate and manipulate.</p>
            </div>

            <!-- Price Information -->
            <p class="price" id="price"><span class="spinner"></span> Fetching price…</p>
            <p class="vtru-conversion" id="vtruConversion">≈ <span id="vtruValue">--</span> VTRU</p>
            <p class="vtru-conversion" id="exchangeRateDisplay">1 VTRU = <span id="exchangeRate">--</span> USDC</p>

            <button id="mintBtn" disabled>Mint Your Ninja Cat</button>
            <div id="status"></div>
            <div id="mint-status"></div>

            <!-- Enhanced Progress Timeline -->
            <div class="progress-container">
                <div class="progress-bar"></div>
            </div>
            <div class="task-progress-timeline" id="taskTimeline" style="display: none;">
                <div class="timeline-stage" data-stage="art">
                    <div class="stage-icon">🎨</div>
                    <div class="stage-label">Art Generation</div>
                    <div class="stage-status">Waiting...</div>
                </div>
                <div class="timeline-stage" data-stage="metadata">
                    <div class="stage-icon">🧠</div>
                    <div class="stage-label">Metadata Build</div>
                    <div class="stage-status">Waiting...</div>
                </div>
                <div class="timeline-stage" data-stage="ipfs">
                    <div class="stage-icon">🗂</div>
                    <div class="stage-label">IPFS Upload</div>
                    <div class="stage-status">Waiting...</div>
                </div>
                <div class="timeline-stage" data-stage="tokenuri">
                    <div class="stage-icon">✅</div>
                    <div class="stage-label">Final TokenURI Set</div>
                    <div class="stage-status">Waiting...</div>
                </div>
            </div>

            <!-- Enhanced Download + Sharing section -->
            <div id="downloadSection" class="download-section" style="display: none;">
                <h4>🎉 Your NFT is ready!</h4>
                <p>Download your ninja cat, share it with the world, or keep a local copy of your digital warrior.</p>
                <div class="download-buttons">
                    <button id="downloadImage" class="download-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                            <path d="M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zm-1-4l-1.41-1.41L13 12.17V4h-2v8.17L8.41 9.59 7 11l5 5 5-5z" />
                        </svg>
                        Download Image
                    </button>
                    <button id="downloadMetadata" class="download-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                            <path d="M19 9h-4V3H9v6H5l7 7 7-7zm-8 2V5h2v6h1.17L12 13.17 9.83 11H11zm-6 7h14v2H5z" />
                        </svg>
                        Download Metadata
                    </button>
                    <button id="downloadZip" class="download-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                            <path d="M19 9h-4V3H9v6H5l7 7 7-7zm-8 2V5h2v6h1.17L12 13.17 9.83 11H11zm-6 7h14v2H5z" />
                        </svg>
                        Download ZIP
                    </button>
                </div>
                <div class="sharing-section">
                    <h5>Share Your NFT</h5>
                    <div class="sharing-buttons">
                        <button id="copyTokenURI" class="share-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                                <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                            </svg>
                            Copy Token URI
                        </button>
                        <button id="shareTwitter" class="share-btn twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                            Share on X
                        </button>
                    </div>
                </div>
            </div>

            <p class="disclaimer">By minting, you'll receive a completely unique AI-generated Ninja Cat NFT with randomly assigned traits, colors and abilities.</p>
            <p class="disclaimer" style="font-size: 0.8rem; font-style: italic;">Keyboard shortcuts: Alt+M to mint</p>
        </section>

        <!-- FUN FACTS -->
        <section class="facts">
            <h3>Ninja-Kitty Lore &amp; Trivia</h3>
            <ul id="factList">
                <li>Each katana is forged from fallen star-iron that landed during the blockchain genesis event.</li>
                <li>A ninja cat's whiskers can detect incoming gas spikes three blocks before they happen.</li>
                <li>Maine Coon ninjas are twice as fluffy yet just as silent as their sleeker counterparts.</li>
                <li>Calico clan masters perfected the "silent meow" - a technique that paralizes enemy smart contracts.</li>
                <li>The ancient Felidae Shinobi scrolls pre-date ERC-721 by thousands of digital cycles.</li>
                <li>Bengal ninjas once patched a rogue contract bug mid-battle, saving countless wallets.</li>
                <li>Siamese ninjas can communicate telepathically with other cats across different blockchains.</li>
                <li>Sphynx ninjas can phase through digital walls by temporarily converting to pure hexadecimal.</li>
                <li>Shadow ninjas leave no transaction traces when moving between contracts.</li>
                <li>Nyan ninjas can traverse the entire blockchain in a single bound, leaving a rainbow trail.</li>
                <li>Persian ninjas invented the first anti-MEV protection mechanisms through elaborate fur-based encryption.</li>
                <li>Tabby ninjas possess the ability to predict gas prices with uncanny accuracy.</li>
            </ul>
        </section>
    </div>

    <!-- Import configuration for use in the carousel -->
    <script type="module">
        import { RPC_URL, CONTRACT_ADDRESS, NFT_ABI } from './js/config.js';

        // Make these available to the non-module script
        window.NFT_CONFIG = {
            RPC_URL,
            CONTRACT_ADDRESS,
            NFT_ABI
        };
    </script>

    <!-- NFT Carousel script -->
    <script>
        // Facts rotator
        const facts = [...document.querySelectorAll('#factList li')]; let i = 0;
        facts.forEach((f, n) => n && (f.style.display = 'none'));
        setInterval(() => {
            facts[i].style.display = 'none'; i = (i + 1) % facts.length;
            facts[i].style.display = 'list-item';
        }, 6000);

        // Breed selector functionality
        const breedSelect = document.getElementById('breed');
        const breedInfos = document.querySelectorAll('.breed-info');

        breedSelect.addEventListener('change', function () {
            breedInfos.forEach(info => info.classList.remove('active'));
            const selectedBreed = this.value.toLowerCase().replace(' ', '');
            const infoElement = document.getElementById(selectedBreed + '-info');
            if (infoElement) {
                infoElement.classList.add('active');
            }
        });

        // Advanced options toggle with mobile drawer support
        const advancedToggle = document.getElementById('advancedToggle');
        const advancedOptions = document.getElementById('advancedOptions');

        advancedToggle.addEventListener('click', function () {
            this.classList.toggle('active');
            advancedOptions.classList.toggle('show');
            
            // Add close button for mobile drawer
            if (window.innerWidth <= 480) {
                if (advancedOptions.classList.contains('show')) {
                    // Add close button if not exists
                    if (!advancedOptions.querySelector('.close-drawer')) {
                        const closeBtn = document.createElement('button');
                        closeBtn.className = 'close-drawer';
                        closeBtn.addEventListener('click', () => {
                            advancedOptions.classList.remove('show');
                            advancedToggle.classList.remove('active');
                        });
                        advancedOptions.appendChild(closeBtn);
                    }
                }
            }
        });

        // Close drawer when clicking outside on mobile
        if (window.innerWidth <= 480) {
            advancedOptions.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('show');
                    advancedToggle.classList.remove('active');
                }
            });
        }

        // Download functionality
        function setupNFTDownloads(nftData) {
            const downloadSection = document.getElementById('downloadSection');
            const downloadImage = document.getElementById('downloadImage');
            const downloadMetadata = document.getElementById('downloadMetadata');

            if (!nftData) {
                console.warn("No NFT data available for download");
                // Still show the download section but with disabled buttons
                if (downloadSection) {
                    downloadSection.style.display = 'block';
                }
                return;
            }

            // Show the download section
            downloadSection.style.display = 'block';

            // Clear any existing event listeners by cloning the elements
            const newDownloadImage = downloadImage.cloneNode(true);
            const newDownloadMetadata = downloadMetadata.cloneNode(true);
            downloadImage.parentNode.replaceChild(newDownloadImage, downloadImage);
            downloadMetadata.parentNode.replaceChild(newDownloadMetadata, downloadMetadata);

            // Setup image download
            newDownloadImage.addEventListener('click', async function () {
                try {
                    let imageUrl = nftData.image;

                    // Convert IPFS URL to HTTP if needed
                    if (imageUrl && imageUrl.startsWith('ipfs://')) {
                        imageUrl = imageUrl.replace('ipfs://', 'https://ipfs.io/ipfs/');
                    }

                    if (!imageUrl) {
                        throw new Error('No image URL available');
                    }

                    // Fetch the image
                    const response = await fetch(imageUrl);
                    const blob = await response.blob();

                    // Create a temporary link and trigger download
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = `ninja-cat-${nftData.tokenId || 'image'}.png`;
                    document.body.appendChild(a);
                    a.click();

                    // Clean up
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                } catch (error) {
                    console.error("Error downloading image:", error);
                    alert("Failed to download image. Please try again or check the console for details.");
                }
            });

            // Setup metadata download
            newDownloadMetadata.addEventListener('click', function () {
                try {
                    // Use the full NFT data or just the metadata part
                    const metadataToDownload = nftData.metadata || nftData;
                    
                    // Format metadata as pretty JSON
                    const metadataStr = JSON.stringify(metadataToDownload, null, 2);
                    const blob = new Blob([metadataStr], { type: 'application/json' });

                    // Create a temporary link and trigger download
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = `ninja-cat-${nftData.tokenId || 'metadata'}.json`;
                    document.body.appendChild(a);
                    a.click();

                    // Clean up
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                } catch (error) {
                    console.error("Error downloading metadata:", error);
                    alert("Failed to download metadata. Please try again or check the console for details.");
                }
            });
        }

        // Make the download function available globally for mint.js to use
        window.setupNFTDownloads = setupNFTDownloads;

        // NFT Carousel Functionality - Using imported config
        async function setupNFTCarousel() {
            const carouselTrack = document.getElementById('nftCarousel');
            const dotsContainer = document.getElementById('carouselDots');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            try {
                // Use the global config we exported from the module
                const config = window.NFT_CONFIG;

                if (!config || !config.CONTRACT_ADDRESS) {
                    throw new Error("Contract configuration not available - please check the network connection");
                }

                const provider = new ethers.JsonRpcProvider(config.RPC_URL);
                const contract = new ethers.Contract(
                    config.CONTRACT_ADDRESS,
                    config.NFT_ABI,
                    provider
                );

                console.log("Connected to contract:", config.CONTRACT_ADDRESS);

                // Get total supply
                const totalSupply = await contract.totalSupply();
                console.log("Total NFT supply:", totalSupply);

                if (Number(totalSupply) <= 0) {
                    carouselTrack.innerHTML = '<div class="carousel-item"><p>No ninja cats minted yet. Be the first!</p></div>';
                    return;
                }

                // Get the last 5 tokens or all if less than 5
                const tokenCount = Math.min(5, Number(totalSupply));
                const tokens = [];

                // Get the most recent tokens
                for (let i = 0; i < tokenCount; i++) {
                    const index = Number(totalSupply) - i - 1;
                    if (index >= 0) {
                        try {
                            const tokenId = await contract.tokenByIndex(index);
                            tokens.push(Number(tokenId));
                        } catch (err) {
                            console.warn(`Error getting token at index ${index}:`, err);
                        }
                    }
                }

                console.log("Retrieved tokens:", tokens);

                // Clear loading indicator
                carouselTrack.innerHTML = '';
                dotsContainer.innerHTML = '';

                // Create a fallback image in case IPFS is slow
                const fallbackImage = "assets/detailed_ninja_cat_64.png";

                // Create carousel items
                for (let i = 0; i < tokens.length; i++) {
                    const tokenId = tokens[i];

                    // Create placeholder item while loading metadata
                    const item = document.createElement('div');
                    item.className = 'carousel-item';
                    item.innerHTML = `
                                                    <div class="spinner"></div>
                                                    <p>Loading Ninja Cat #${tokenId}...</p>
                                                `;
                    carouselTrack.appendChild(item);

                    // Create dot
                    const dot = document.createElement('div');
                    dot.className = 'carousel-dot';
                    if (i === 0) dot.classList.add('active');
                    dot.addEventListener('click', () => goToSlide(i));
                    dotsContainer.appendChild(dot);

                    try {
                        // Fetch metadata
                        const uri = await contract.tokenURI(tokenId);
                        console.log(`Token #${tokenId} URI:`, uri);

                        let metadata;

                        if (uri.startsWith('ipfs://')) {
                            // Handle IPFS URI
                            const ipfsHash = uri.replace('ipfs://', '');
                            const ipfsUrl = `https://ipfs.io/ipfs/${ipfsHash}`;
                            const response = await fetch(ipfsUrl);
                            metadata = await response.json();
                        } else {
                            // Handle HTTP URI
                            const response = await fetch(uri);
                            metadata = await response.json();
                        }

                        console.log(`Token #${tokenId} metadata:`, metadata);

                        // Update carousel item with loaded metadata
                        if (metadata && metadata.image) {
                            // Fix IPFS links
                            const imageUrl = metadata.image.startsWith('ipfs://')
                                ? metadata.image.replace('ipfs://', 'https://ipfs.io/ipfs/')
                                : metadata.image;

                            item.innerHTML = `
                                                            <img src="${imageUrl}" alt="${metadata.name}" class="carousel-image" onerror="this.src='${fallbackImage}'">
                                                            <div class="carousel-caption">${metadata.name}</div>
                                                        `;
                        }
                    } catch (metadataError) {
                        console.warn(`Error loading metadata for token #${tokenId}:`, metadataError);
                        item.innerHTML = `
                                                        <img src="${fallbackImage}" alt="Ninja Cat #${tokenId}" class="carousel-image">
                                                        <div class="carousel-caption">Ninja Cat #${tokenId}</div>
                                                    `;
                    }
                }

                // Add a "Mint Yours" slide at the end
                const mintSlide = document.createElement('div');
                mintSlide.className = 'carousel-item';
                mintSlide.innerHTML = `
                                                <div style="text-align: center; padding: 20px;">
                                                    <img src="assets/detailed_ninja_cat_64.png" alt="Mint your own"
                                                        style="width: 80px; height: 80px; margin-bottom: 15px; filter: drop-shadow(0 0 10px rgba(138,101,255,0.5));">
                                                    <h3 style="margin: 0 0 10px 0;">Mint your own Ninja Cat!</h3>
                                                    <p>Join the Ninja Cat collection with your unique warrior.</p>
                                                </div>
                                            `;
                carouselTrack.appendChild(mintSlide);

                // Add dot for mint slide
                const mintDot = document.createElement('div');
                mintDot.className = 'carousel-dot';
                mintDot.addEventListener('click', () => goToSlide(tokens.length));
                dotsContainer.appendChild(mintDot);

                // Set up carousel functionality
                let currentSlide = 0;
                const slides = document.querySelectorAll('.carousel-item');
                const dots = document.querySelectorAll('.carousel-dot');

                function goToSlide(n) {
                    currentSlide = n;
                    carouselTrack.style.transform = `translateX(-${currentSlide * 100}%)`;

                    // Update dots
                    dots.forEach((dot, i) => {
                        dot.classList.toggle('active', i === currentSlide);
                    });
                }

                // Add event listeners for navigation
                prevBtn.addEventListener('click', () => {
                    currentSlide = (currentSlide - 1 + slides.length) % slides.length;
                    goToSlide(currentSlide);
                });

                nextBtn.addEventListener('click', () => {
                    currentSlide = (currentSlide + 1) % slides.length;
                    goToSlide(currentSlide);
                });

                // Auto-rotate
                let interval = setInterval(() => {
                    currentSlide = (currentSlide + 1) % slides.length;
                    goToSlide(currentSlide);
                }, 5000);

                // Pause rotation when hovering
                carouselTrack.addEventListener('mouseenter', () => {
                    clearInterval(interval);
                });

                carouselTrack.addEventListener('mouseleave', () => {
                    interval = setInterval(() => {
                        currentSlide = (currentSlide + 1) % slides.length;
                        goToSlide(currentSlide);
                    }, 5000);
                });

            } catch (error) {
                console.error("Error setting up NFT carousel:", error);
                carouselTrack.innerHTML = `
                                                <div class="carousel-item">
                                                    <img src="assets/detailed_ninja_cat_64.png" alt="Mint your own" style="width: 80px; height: 80px; margin-bottom: 15px;">
                                                    <p>Be the first to mint a Ninja Cat!</p>
                                                    <small style="display: block; margin-top: 10px; color: #666;">Error: ${error.message}</small>
                                                </div>`;
            }
        }

        // Initialize carousel when page loads
        document.addEventListener('DOMContentLoaded', setupNFTCarousel);

        document.addEventListener('DOMContentLoaded', function () {
            // Provider-specific options configuration
            const providerOptions = {
                'dall-e': [
                    {
                        id: 'dalle-model',
                        name: 'model',
                        label: 'Model',
                        type: 'select',
                        options: [
                            { value: 'dall-e-3', label: 'DALL-E 3 (Best Quality)' },
                            { value: 'dall-e-2', label: 'DALL-E 2 (Faster)' }
                        ]
                    },
                    {
                        id: 'dalle-quality',
                        name: 'quality',
                        label: 'Quality',
                        type: 'select',
                        options: [
                            { value: 'hd', label: 'High Definition' },
                            { value: 'standard', label: 'Standard' }
                        ]
                    },
                    {
                        id: 'dalle-style',
                        name: 'style',
                        label: 'Style',
                        type: 'select',
                        options: [
                            { value: 'vivid', label: 'Vivid' },
                            { value: 'natural', label: 'Natural' }
                        ]
                    }
                ],
                'stability': [
                    {
                        id: 'stability-preset',
                        name: 'stylePreset',
                        label: 'Style Preset',
                        type: 'select',
                        options: [
                            { value: 'pixel-art', label: 'Pixel Art' },
                            { value: 'anime', label: 'Anime' },
                            { value: '3d-model', label: '3D Model' },
                            { value: 'photographic', label: 'Photographic' },
                            { value: 'digital-art', label: 'Digital Art' }
                        ]
                    }
                ],
                'huggingface': [
                    {
                        id: 'hf-model',
                        name: 'model',
                        label: 'Model',
                        type: 'select',
                        options: [
                            { value: 'stabilityai/stable-diffusion-xl-base-1.0', label: 'SDXL (High Quality)' },
                            { value: 'prompthero/openjourney', label: 'Openjourney (Midjourney Style)' },
                            { value: 'runwayml/stable-diffusion-v1-5', label: 'SD 1.5 (Faster)' }
                        ]
                    }
                ]
            };

            // Create option panels for each provider
            const optionsContainer = document.querySelector('.provider-options-container');

            for (const [provider, options] of Object.entries(providerOptions)) {
                const panel = document.createElement('div');
                panel.id = `${provider}-options`;
                panel.className = 'provider-option-panel';
                panel.style.display = 'none';

                // Create form elements for each option
                options.forEach(option => {
                    const group = document.createElement('div');
                    group.className = 'option-group';

                    // Create label
                    const label = document.createElement('label');
                    label.className = 'option-label';
                    label.htmlFor = option.id;
                    label.textContent = option.label;
                    group.appendChild(label);

                    if (option.type === 'select') {
                        // Create select input
                        const select = document.createElement('select');
                        select.id = option.id;
                        select.name = option.name;
                        select.className = 'form-control';

                        // Add options
                        option.options.forEach(opt => {
                            const optEl = document.createElement('option');
                            optEl.value = opt.value;
                            optEl.textContent = opt.label;
                            select.appendChild(optEl);
                        });

                        group.appendChild(select);
                    }

                    panel.appendChild(group);
                });

                optionsContainer.appendChild(panel);
            }

            // Show the default provider options
            const defaultProvider = 'dall-e';
            const defaultPanel = document.getElementById(`${defaultProvider}-options`);
            if (defaultPanel) defaultPanel.style.display = 'block';

            // Helper function to update the generation summary
            window.updateGenerationSummary = function () {
                const summaryEl = document.getElementById('generationSummary');
                if (!summaryEl) return;

                const provider = document.getElementById('imageProvider').value;
                const extras = document.getElementById('promptExtras').value ? 'with custom prompt' : '';
                const negative = document.getElementById('negativePrompt').value ? 'and negative prompt' : '';

                let summary = `Using ${provider} for image generation`;
                if (extras || negative) {
                    summary += ` (${extras} ${negative})`.replace('  ', ' ').trim();
                }

                summaryEl.textContent = summary;
            };
        });

        // COMBINED PROVIDER SELECTOR FUNCTIONALITY
        document.addEventListener('DOMContentLoaded', function () {
            const imageProvider = document.getElementById('imageProvider');
            const providerInfos = document.querySelectorAll('.provider-info');

            if (imageProvider) {
                // Remove any existing event listeners first by cloning the element
                const oldElement = imageProvider;
                const newElement = oldElement.cloneNode(true);
                oldElement.parentNode.replaceChild(newElement, oldElement);

                // Add the combined event listener to the new element
                newElement.addEventListener('change', function () {
                    // Part 1: Update provider info panels
                    providerInfos.forEach(info => info.classList.remove('active'));
                    const selectedProvider = this.value.toLowerCase();
                    const providerInfo = document.getElementById(selectedProvider + '-info');
                    if (providerInfo) providerInfo.classList.add('active');

                    // Part 2: Update provider option panels
                    document.querySelectorAll('.provider-option-panel').forEach(panel => {
                        panel.style.display = 'none';
                    });
                    const optionPanel = document.getElementById(`${selectedProvider}-options`);
                    if (optionPanel) {
                        optionPanel.style.display = 'block';
                    }

                    // Store the selected provider in a data attribute for the server to use
                    document.body.setAttribute('data-selected-provider', selectedProvider);
                    console.log(`Selected image provider: ${selectedProvider}`);

                    // Update generation summary if applicable
                    if (window.updateGenerationSummary) {
                        window.updateGenerationSummary();
                    }
                });

                // Trigger change event on page load to set initial state
                const event = new Event('change');
                newElement.dispatchEvent(event);
            }
        });
    </script>
    <script type="module">
        // LP Pool contract address for VTRU/USDC
        const LP_POOL_ADDRESS = "0x8B3808260a058ECfFA9b1d0eaA988A1b4167DDba";
        const VTRU_ADDRESS = "0x3ccc3F22462cAe34766820894D04a40381201ef9";
        const USDC_ADDRESS = "0xbCfB3FCa16b12C7756CD6C24f1cC0AC0E38569CF";

        // Minimal ABI for LP pool reserves query
        const LP_POOL_ABI = [
            {
                "inputs": [],
                "name": "getReserves",
                "outputs": [
                    { "internalType": "uint112", "name": "reserve0", "type": "uint112" },
                    { "internalType": "uint112", "name": "reserve1", "type": "uint112" },
                    { "internalType": "uint32", "name": "blockTimestampLast", "type": "uint32" }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "token0",
                "outputs": [{ "internalType": "address", "name": "", "type": "address" }],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "token1",
                "outputs": [{ "internalType": "address", "name": "", "type": "address" }],
                "stateMutability": "view",
                "type": "function"
            }
        ];

        // Make exchange rate fetching available globally
        window.getExchangeRate = async function () {
            try {
                // Connect to blockchain
                const provider = new ethers.JsonRpcProvider(window.NFT_CONFIG?.RPC_URL || "https://rpc.vitruveo.xyz");
                const lpPool = new ethers.Contract(LP_POOL_ADDRESS, LP_POOL_ABI, provider);

                // Get token positions in the pool (order matters for reserves)
                const token0 = await lpPool.token0();
                const token1 = await lpPool.token1();

                // Get reserves
                const reserves = await lpPool.getReserves();

                // Determine which reserve is VTRU and which is USDC
                let vtruReserve, usdcReserve;
                const isVtruToken0 = token0.toLowerCase() === VTRU_ADDRESS.toLowerCase();

                if (isVtruToken0) {
                    vtruReserve = reserves[0];
                    usdcReserve = reserves[1];
                } else {
                    vtruReserve = reserves[1];
                    usdcReserve = reserves[0];
                }

                // Calculate exchange rate (VTRU price in USDC)
                // USDC typically has 6 decimals, VTRU has 18
                const vtruDecimals = 18;
                const usdcDecimals = 6;

                const vtruAmount = parseFloat(vtruReserve) / (10 ** vtruDecimals);
                const usdcAmount = parseFloat(usdcReserve) / (10 ** usdcDecimals);

                // Calculate exchange rate: VTRU price in USDC
                const exchangeRate = usdcAmount / vtruAmount;
                console.log(`LP pool exchange rate: 1 VTRU = ${exchangeRate.toFixed(6)} USDC`);

                return exchangeRate;
            } catch (error) {
                console.error("Failed to fetch exchange rate:", error);
                return null;
            }
        };

        // Initialize VTRU conversion and navbar price display
        document.addEventListener('DOMContentLoaded', async function () {
            try {
                // Get the current exchange rate
                const exchangeRate = await window.getExchangeRate();

                // Update navbar price indicator
                updateNavbarPrice(exchangeRate);
                
                // Immediately update the exchange rate display
                const exchangeRateEl = document.getElementById('exchangeRate');
                const exchangeRateDisplayEl = document.getElementById('exchangeRateDisplay');
                if (exchangeRateEl && exchangeRateDisplayEl && exchangeRate) {
                    exchangeRateEl.textContent = exchangeRate.toFixed(4);
                    exchangeRateDisplayEl.style.display = 'block';
                }

                // Try to update VTRU conversion immediately if price is already available
                updateVtruConversion(null, exchangeRate);

                // Set interval to update price every 60 seconds
                setInterval(async () => {
                    const latestRate = await window.getExchangeRate();
                    updateNavbarPrice(latestRate);
                }, 60000);

                // Setup price observer to convert prices in the mint card
                const priceElement = document.getElementById('price');
                if (priceElement) {
                    // Function to check and update VTRU conversion
                    const checkAndUpdateVtruConversion = () => {
                        const priceText = priceElement.innerText || priceElement.textContent;
                        const priceMatch = priceText.match(/(\d+(\.\d+)?)/);
                        if (priceMatch && priceMatch[1]) {
                            updateVtruConversion(priceMatch[1], exchangeRate);
                        }
                    };
                    
                    // Initial check of existing price
                    checkAndUpdateVtruConversion();
                    
                    // Check again after short delays in case the price loads later
                    setTimeout(checkAndUpdateVtruConversion, 1000);
                    setTimeout(checkAndUpdateVtruConversion, 3000);
                    setTimeout(checkAndUpdateVtruConversion, 5000);

                    // Monitor for price changes
                    const observer = new MutationObserver(function (mutations) {
                        mutations.forEach(function (mutation) {
                            checkAndUpdateVtruConversion();
                        });
                    });

                    observer.observe(priceElement, {
                        characterData: true,
                        childList: true,
                        subtree: true
                    });
                }
            } catch (err) {
                console.warn("Error setting up VTRU price displays:", err);
            }
        });

        // Function to update the navbar price display
        function updateNavbarPrice(exchangeRate) {
            const priceEl = document.getElementById('vtruPrice');
            if (!priceEl) return;

            if (exchangeRate && !isNaN(exchangeRate)) {
                priceEl.textContent = exchangeRate.toFixed(4);
            } else {
                priceEl.textContent = "--.--";
            }
        }

        // Function to update VTRU price conversion in the mint card
        function updateVtruConversion(usdcPrice, exchangeRate) {
            const vtruElement = document.getElementById('vtruValue');
            const vtruConversionEl = document.getElementById('vtruConversion');
            const exchangeRateEl = document.getElementById('exchangeRate');
            const exchangeRateDisplayEl = document.getElementById('exchangeRateDisplay');

            // Set the exchange rate display - always show it if we have a rate
            if (exchangeRateEl && exchangeRateDisplayEl) {
                if (exchangeRate && !isNaN(exchangeRate)) {
                    exchangeRateEl.textContent = exchangeRate.toFixed(4);
                    exchangeRateDisplayEl.style.display = 'block';
                } else {
                    exchangeRateEl.textContent = '--';
                    exchangeRateDisplayEl.style.display = 'block';
                }
            }

            if (!vtruElement || !vtruConversionEl) return;

            // Always show the VTRU conversion display
            vtruConversionEl.style.display = 'block';

            if (usdcPrice && !isNaN(usdcPrice)) {
                if (exchangeRate && !isNaN(exchangeRate)) {
                    // Calculate how many VTRU you get for the USDC price
                    const vtruValue = (parseFloat(usdcPrice) / exchangeRate).toFixed(2);
                    vtruElement.textContent = vtruValue;
                } else {
                    vtruElement.textContent = "N/A";
                }
            } else {
                vtruElement.textContent = "--";
            }
        }
    </script>

    <!-- Include the footer -->
    <script src="/js/audio-player.js"></script>
    <footer id="footer"></footer>
    <script type="module" src="js/footer.js"></script>
    <!-- Add right before the wallet script -->
    <script type="module" src="js/navbar.js"></script>
    <!-- Replace the script at the bottom with this corrected version -->
    <script type="module">
        // First initialize global NFT config
        import { RPC_URL, CONTRACT_ADDRESS, NFT_ABI } from './js/config.js';
        window.NFT_CONFIG = {
            RPC_URL,
            CONTRACT_ADDRESS,
            NFT_ABI
        };

        // Load the wallet system first
        import './js/wallet.js';

        // Then load navbar
        import './js/navbar.js';

        // Then load mint.js
        import './js/mint.js';
    </script>

    <!-- Vercel Analytics -->
    <script>
        window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/insights/script.js"></script>
</body>
</html>
