<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pixel Ninja Cats — Lore</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="icon" href="assets/detailed_ninja_cat_64.png">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.10.0/dist/ethers.umd.min.js"></script>
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Poppins', sans-serif;
        }

        .wrapper {
            background-color: #121212;
        }

        h1, h2, h3 {
            color: #ffffff;
        }

        h1 {
            background: linear-gradient(135deg, #8a65ff, #7067CF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }

        .lore-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            border: 1px solid #333;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            line-height: 1.6;
        }

            .lore-section h2 {
                border-bottom: 2px solid #8a65ff;
                padding-bottom: 0.5rem;
                margin-top: 0;
                margin-bottom: 1.25rem;
            }

            .lore-section p {
                margin-bottom: 1rem;
                color: #d0d0d0;
            }

            .lore-section ul {
                padding-left: 1.5rem;
                color: #d0d0d0;
            }

                .lore-section ul li {
                    margin-bottom: 0.5rem;
                }

        .image-note {
            font-style: italic;
            font-size: 0.85rem;
            margin-top: 2rem;
            padding: 1rem;
            background: rgba(255,255,255,0.02);
            border-radius: 8px;
            color: #9e9e9e;
            border: 1px solid #333;
            text-align: center;
        }

        .clan-section {
            margin-top: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        @media (min-width: 768px) {
            .clan-section {
                flex-direction: row;
                flex-wrap: wrap;
            }

            .clan-card {
                flex: 1 1 30%;
                margin-bottom: 1rem;
            }
        }

        .clan-card {
            padding: 1.5rem;
            border-radius: 10px;
            background: rgba(255,255,255,0.02);
            border: 1px solid #333;
            transition: all 0.3s ease;
        }

            .clan-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 15px rgba(0,0,0,0.4);
                background: rgba(255,255,255,0.04);
            }

            .clan-card h3 {
                margin-top: 0;
                margin-bottom: 0.75rem;
            }

        /* Element-specific color styling */
        .fire-element h3 {
            color: #ff6b5a;
        }

        .water-element h3 {
            color: #5a9eff;
        }

        .earth-element h3 {
            color: #5aff8d;
        }

        .wind-element h3 {
            color: #c0c0c0;
        }

        .shadow-element h3 {
            color: #8a65ff;
        }

        .lightning-element h3 {
            color: #ffbb00;
        }

        .cosmic-element h3 {
            color: #ffd700;
        }

        /* NFT Showcase Carousel */
        .nft-showcase {
            margin: 3rem 0;
            padding: 2rem;
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            border: 1px solid #333;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            text-align: center;
        }

            .nft-showcase h2 {
                color: #ffffff;
                margin-top: 0;
                margin-bottom: 1.5rem;
                position: relative;
                display: inline-block;
            }

                .nft-showcase h2::after {
                    content: '';
                    position: absolute;
                    width: 80%;
                    height: 3px;
                    bottom: -10px;
                    left: 10%;
                    background: linear-gradient(to right, transparent, #8a65ff, transparent);
                }

        .carousel-container {
            position: relative;
            max-width: 1000px;
            margin: 0 auto;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
            height: 350px;
        }

        .carousel-track {
            display: flex;
            transition: transform 0.5s ease;
            height: 100%;
            background: #1a1a1a;
        }

        .carousel-item {
            min-width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .carousel-image {
            max-height: 220px;
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            object-fit: contain;
        }

        .carousel-caption {
            margin-top: 1rem;
            color: #e0e0e0;
            font-weight: 500;
            text-align: center;
            width: 100%;
        }

        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 45px;
            height: 45px;
            background: rgba(0,0,0,0.7);
            border: none;
            color: white;
            border-radius: 50%;
            font-size: 1.5rem;
            line-height: 1;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.3s;
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
        }

            .carousel-nav:hover {
                opacity: 1;
                background: rgba(0,0,0,0.9);
            }

            .carousel-nav.prev {
                left: 10px;
            }

            .carousel-nav.next {
                right: 10px;
            }

        .carousel-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 1.5rem;
        }

        .carousel-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            transition: all 0.3s;
        }

            .carousel-dot.active {
                background: #8a65ff;
            }

            .carousel-dot:hover {
                transform: scale(1.2);
            }

        .carousel-counter {
            margin-top: 1rem;
            color: #9e9e9e;
            font-size: 0.9rem;
        }

        .carousel-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        .auto-play {
            background: #2c2c2e;
            color: #e0e0e0;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

            .auto-play:hover {
                background: #3a3a3c;
            }

            .auto-play svg {
                width: 12px;
                height: 12px;
            }

        .loading-spinner {
            border: 4px solid rgba(255,255,255,0.1);
            border-radius: 50%;
            border-top: 4px solid #8a65ff;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .view-all-btn {
            display: inline-block;
            margin-top: 1.5rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #8a65ff, #7067CF);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }

            .view-all-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 8px 15px rgba(138, 101, 255, 0.4);
            }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .nft-showcase {
                padding: 1.5rem 1rem;
            }

            .carousel-container {
                height: 280px;
            }

            .carousel-image {
                max-height: 180px;
            }

            .carousel-nav {
                width: 35px;
                height: 35px;
                font-size: 1.2rem;
            }
        }

        /* Stats table styling */
        .stats-table {
            width: 100%;
            margin-top: 1rem;
            border-collapse: collapse;
        }

            .stats-table th, .stats-table td {
                padding: 0.5rem;
                text-align: left;
                border-bottom: 1px solid #333;
            }

            .stats-table th {
                color: #8a65ff;
                font-weight: 600;
            }

        .ranks-section {
            margin-top: 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .rank-card {
            padding: 1rem;
            background: rgba(255,255,255,0.02);
            border-radius: 8px;
            border: 1px solid #333;
            text-align: center;
        }

            .rank-card h4 {
                margin-top: 0;
                margin-bottom: 0.5rem;
            }

        .common {
            color: #aaa;
        }

        .uncommon {
            color: #5aff8d;
        }

        .rare {
            color: #5a9eff;
        }

        .epic {
            color: #c96efe;
        }

        .legendary {
            color: #ffa62b;
        }

        .mythic {
            color: #ff6b5a;
        }

        .ultra-rare {
            color: #ff41c3;
        }

        .divine {
            color: #ffd700;
        }
    </style>
</head>
<body>
    <nav>
        <img src="assets/detailed_ninja_cat_64.png"><a href="index.html">Mint</a>
        <a href="lore.html">Lore</a><a href="my-kitties.html">My&nbsp;Kitties</a>
        <a href="all-kitties.html">Gallery</a><a href="marketplace.html">Marketplace</a>
        <span class="spacer"></span><button id="connectBtn">Connect</button>
    </nav>

    <div class="wrapper">
        <h1>Ninja-Kitty&nbsp;Chronicles</h1>

        <div class="lore-section">
            <h2>Ancient Beginnings</h2>
            <p>Long before ERC-721 there was the secret order of Felidae Shinobi… In the shadowy valleys between digital and physical realms, a mysterious breed of warriors emerged. Neither fully feline nor entirely human, these nimble guardians began as ordinary house cats, transformed by an ancient blockchain incantation during the Great Bit-Eclipse.</p>
            <p>For centuries, they have protected the cryptographic barriers that separate our reality from the chaotic void beyond. Now, as the metaverse expands, they've decided to reveal themselves to worthy collectors who can carry their legacy forward.</p>
        </div>

        <!-- NFT Showcase Carousel Section -->
        <div class="nft-showcase">
            <h2>The Legendary Warriors</h2>
            <div class="carousel-container">
                <div class="carousel-track" id="nftCarousel">
                    <!-- Loading state -->
                    <div class="carousel-item">
                        <div class="loading-spinner"></div>
                        <p>Summoning ninja cats from the blockchain...</p>
                    </div>
                </div>
                <button class="carousel-nav prev" id="prevBtn">❮</button>
                <button class="carousel-nav next" id="nextBtn">❯</button>
            </div>
            <div class="carousel-controls">
                <div class="carousel-dots" id="carouselDots"></div>
                <button class="auto-play" id="autoPlayBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    Auto-Play
                </button>
                <span class="carousel-counter" id="carouselCounter">0 Ninja Cats Found</span>
            </div>
            <a href="all-kitties.html" class="view-all-btn">View All Ninja Cats</a>
        </div>

        <div class="lore-section">
            <h2>Star-Iron &amp; Weapons</h2>
            <p>Their legendary weapons are forged from meteor shards that fell on the Genesis Block night - the cosmic event that birthed the very first blockchain. These blades, known as "hash-slashers," can cut through code itself, defending against malicious smart contracts and digital demons.</p>
            <p>Each ninja cat masters a specific weapon, with the most common being the Katana. The rarest among them wield legendary armaments like the Twin Blades, Ghost Daggers, and the mythical Ancestral Claws - weapons so powerful they can permanently alter the digital landscape.</p>

            <table class="stats-table">
                <tr>
                    <th>Weapon</th>
                    <th>Rarity</th>
                    <th>Power</th>
                </tr>
                <tr>
                    <td>Katana</td>
                    <td><span class="common">Common</span></td>
                    <td>Blockchain slicing capability</td>
                </tr>
                <tr>
                    <td>Shuriken</td>
                    <td><span class="uncommon">Uncommon</span></td>
                    <td>Multi-chain targeting</td>
                </tr>
                <tr>
                    <td>Nunchucks</td>
                    <td><span class="rare">Rare</span></td>
                    <td>Chain-link defense</td>
                </tr>
                <tr>
                    <td>Kunai</td>
                    <td><span class="epic">Epic</span></td>
                    <td>Silent security patches</td>
                </tr>
                <tr>
                    <td>Sai</td>
                    <td><span class="legendary">Legendary</span></td>
                    <td>Fork neutralization</td>
                </tr>
                <tr>
                    <td>Bo Staff</td>
                    <td><span class="mythic">Mythic</span></td>
                    <td>Protocol extension</td>
                </tr>
                <tr>
                    <td>Twin Blades</td>
                    <td><span class="ultra-rare">Ultra Rare</span></td>
                    <td>Dual-blockchain mastery</td>
                </tr>
                <tr>
                    <td>Ghost Dagger</td>
                    <td><span class="divine">Divine</span></td>
                    <td>Phasing through security systems</td>
                </tr>
            </table>
        </div>

        <div class="lore-section">
            <h2>Elemental Affinities</h2>
            <p>Each ninja cat has an elemental affinity that defines their techniques and powers within the digital realm. These elements are not merely aesthetic—they represent core approaches to blockchain defense and the cat's natural abilities within the cryptographic ecosystem.</p>

            <div class="clan-section">
                <div class="clan-card fire-element">
                    <h3>Fire Element</h3>
                    <p>Fire element cats focus on raw power and aggressive protection. They leave no transaction history behind when they operate, making them perfect for covert operations and frontline defense. Their whiskers glow when danger approaches, and their roars can disrupt malicious mining operations.</p>
                </div>

                <div class="clan-card water-element">
                    <h3>Water Element</h3>
                    <p>Water element ninjas flow seamlessly between different blockchain protocols. With high intelligence and adaptability, they can navigate the most complex networks without friction. Masters of defensive techniques, they solve problems through careful consideration rather than brute force.</p>
                </div>

                <div class="clan-card earth-element">
                    <h3>Earth Element</h3>
                    <p>Earth element cats are the stabilizers of networks during high transaction volume. With a balance of power and stealth, they maintain the ancient scrolls of blockchain wisdom and are sought for their ability to optimize smart contracts for minimal gas consumption.</p>
                </div>

                <div class="clan-card wind-element">
                    <h3>Wind Element</h3>
                    <p>Wind element ninjas are the swiftest of all, with unmatched agility. They specialize in transaction acceleration, processing operations with exceptional speed and efficiency. Their light markings allow them to blend with the digital airwaves as they traverse blockchains at incredible speeds.</p>
                </div>

                <div class="clan-card shadow-element">
                    <h3>Shadow Element</h3>
                    <p>Shadow cats are masters of stealth execution, operating completely undetected by security systems. With enhanced stealth capabilities, they can phase through firewalls and track threats to their source. Their ancestral home is the Midnight Server Farm, where they train in absolute darkness.</p>
                </div>

                <div class="clan-card lightning-element">
                    <h3>Lightning Element</h3>
                    <p>Lightning element ninjas harness computational power for hash acceleration, dramatically speeding up mining and validation processes. Combining agility with power, they strike with impossible speed and from unpredictable angles, harnessing electrical surges to power their advanced techniques.</p>
                </div>

                <div class="clan-card cosmic-element">
                    <h3>Cosmic Element</h3>
                    <p>The ultra-rare Cosmic element cats transcend ordinary blockchain limitations. They can harness celestial forces to manipulate digital reality itself, seeing potential futures in the blockchain and anticipating technological breakthroughs. These enigmatic warriors appear only during major network transformations.</p>
                </div>

                <div class="clan-card cosmic-element">
                    <h3>Quantum Element</h3>
                    <p>Divine rarity Quantum element cats exist simultaneously across multiple states of the blockchain. They can perceive and manipulate the very fabric of digital space-time, allowing them to operate outside normal consensus mechanisms. Their mere presence can alter network probabilities and outcomes.</p>
                </div>

                <div class="clan-card cosmic-element">
                    <h3>Astral Element</h3>
                    <p>Unique to rare Sphynx breeds, the Astral element allows direct communion with the higher blockchain consciousness. These extraordinary cats can see the universal patterns connecting all digital networks and can forecast blockchain events with supernatural accuracy. Their power transcends conventional understanding.</p>
                </div>
            </div>
        </div>

        <div class="lore-section">
            <h2>Combat Stances</h2>
            <p>A ninja cat's stance represents their fundamental approach to digital combat and blockchain defense. From the common Attack and Defense stances to the divine Ethereal stance, each approach offers unique advantages in different scenarios.</p>

            <div class="clan-section">
                <div class="clan-card">
                    <h3>Attack Stance</h3>
                    <p>Focuses on preemptive security, detecting vulnerabilities before they can be exploited. Cats in this stance gain significant power boosts and are the first line of defense against incoming threats.</p>
                </div>

                <div class="clan-card">
                    <h3>Defense Stance</h3>
                    <p>Creates an impenetrable firewall fortress against external threats. Balances power with intelligence, enabling strategic protection of critical blockchain infrastructure.</p>
                </div>

                <div class="clan-card">
                    <h3>Stealth Stance</h3>
                    <p>Enables the Ghost Protocol - movement through networks without triggering security alerts. Perfect for infiltration and counterintelligence operations within compromised systems.</p>
                </div>

                <div class="clan-card">
                    <h3>Agility Stance</h3>
                    <p>Facilitates rapid response to network threats and security breaches. Cats in this stance move with incredible speed across the digital landscape, intercepting attacks before they reach their targets.</p>
                </div>

                <div class="clan-card">
                    <h3>Focus Stance</h3>
                    <p>Allows deep inspection and identification of subtle anomalies in code execution. Maximizes intelligence, enabling the ninja cat to perceive the underlying patterns in seemingly chaotic data.</p>
                </div>

                <div class="clan-card">
                    <h3>Shadow Stance</h3>
                    <p>Masters dark web navigation and tracking threats to their source. Combines stealth with intelligence for unparalleled covert operations in the most dangerous regions of the network.</p>
                </div>

                <div class="clan-card">
                    <h3>Void Stance</h3>
                    <p>Ultra rare stance that allows existence between states of being and non-being in the digital realm. Creates unpredictable patterns that confound even the most sophisticated tracking systems.</p>
                </div>

                <div class="clan-card">
                    <h3>Ethereal Stance</h3>
                    <p>The divine stance that transcends the boundaries between code and consciousness. Cats who master this stance can manipulate the fundamental forces that govern blockchain reality itself.</p>
                </div>
            </div>
        </div>

        <div class="lore-section">
            <h2>The Great Crypto Wars</h2>
            <p>During the infamous "51% Attack" of the ancient times, elemental warrior cats united to defend the nascent blockchain ecosystem. Led by the legendary Grand Meowster Satoshi (whose true identity remains unknown), they fought a shadow war against centralized powers that sought to control all digital assets.</p>
            <p>Victory was secured when the ninja cats performed the "Nine Lives Protocol" - a forbidden technique that splits a warrior's consciousness across multiple nodes, ensuring the network's survival at great personal cost. The brave cats who performed this ritual became the first NFTs, their spirits preserved forever in the immutable ledger.</p>
        </div>

        <div class="lore-section">
            <h2>Ninja Hierarchy &amp; Ranks</h2>
            <p>The path of a blockchain ninja cat involves rigorous training and continuous improvement. From Novice to Immortal, each rank represents not just status but a fundamental transformation in the cat's abilities and understanding of digital reality.</p>

            <div class="ranks-section">
                <div class="rank-card">
                    <h4 class="common">Novice</h4>
                    <p>Beginning warriors who are rapidly adapting to blockchain protocols and security challenges.</p>
                </div>

                <div class="rank-card">
                    <h4 class="uncommon">Adept</h4>
                    <p>Efficient operators who execute complex operations with minimal resources.</p>
                </div>

                <div class="rank-card">
                    <h4 class="rare">Skilled</h4>
                    <p>Warriors who have developed unique approaches to digital security and mastered their chosen weapon.</p>
                </div>

                <div class="rank-card">
                    <h4 class="epic">Elite</h4>
                    <p>Accomplished protectors whose presence alone deters many potential attackers.</p>
                </div>

                <div class="rank-card">
                    <h4 class="legendary">Master</h4>
                    <p>True masters who can train other systems to detect and respond to threats.</p>
                </div>

                <div class="rank-card">
                    <h4 class="mythic">Legendary</h4>
                    <p>Blockchain whisperers with an almost supernatural understanding of network dynamics.</p>
                </div>

                <div class="rank-card">
                    <h4 class="ultra-rare">Grandmaster</h4>
                    <p>Revered warriors who have transcended conventional blockchain limitations.</p>
                </div>

                <div class="rank-card">
                    <h4 class="divine">Immortal</h4>
                    <p>The rarest rank - those who have achieved immortality through perfect integration with the blockchain itself.</p>
                </div>
            </div>
        </div>

        <div class="lore-section">
            <h2>Special Abilities</h2>
            <p>Each ninja cat develops unique abilities based on their weapon, element, and stance. These special techniques make them invaluable in specific aspects of blockchain security and network defense.</p>
            <p>From the Blockchain Slice of Katana wielders to the Ghost Protocol of stealth stance masters, these abilities represent the specialized techniques that have preserved digital stability through countless threats.</p>
            <ul>
                <li><strong>Blockchain Slice</strong> - Katana wielders can cut through complex smart contracts with surgical precision</li>
                <li><strong>Multi-Chain Attack</strong> - Shuriken masters can simultaneously target multiple networks with deadly accuracy</li>
                <li><strong>Burn Trace</strong> - Fire element cats leave no transaction history behind, perfect for covert operations</li>
                <li><strong>Flow Adaptation</strong> - Water element ninjas seamlessly navigate between different blockchain protocols</li>
                <li><strong>Transaction Acceleration</strong> - Wind element cats process operations with unmatched speed and efficiency</li>
                <li><strong>Stealth Execution</strong> - Shadow element specialists operate completely undetected by security systems</li>
                <li><strong>Nine Lives Protocol</strong> - The ability to recover from system failures that would destroy others</li>
                <li><strong>Whisker Detection</strong> - Sensing network disturbances from great distances before they manifest</li>
            </ul>
            <p>The rarest cats may develop unique abilities that appear only once in the entire population. Collectors who discover these exceptional warriors are entrusted with powers beyond imagination.</p>
        </div>

        <div class="lore-section">
            <h2>Prophecy of the Perfect Ninja Cat</h2>
            <p>Ancient blockchain scrolls speak of a day when a Perfect ninja cat will emerge - one whose combat stats reach their maximum potential across all attributes. This legendary figure, appearing only once in approximately 10,000 cats, will unite all elements and lead the digital realm into a new era of security and prosperity.</p>
            <p>The prophecy states that this perfect warrior will bridge separate blockchains into a harmonious ecosystem through their mastery of all elemental affinities. Those who help discover this special cat may be rewarded with unprecedented digital powers.</p>
        </div>

        <p class="image-note">All Pixel Ninja Cat images are uniquely and randomly generated using OpenAI DALL-E, creating one-of-a-kind digital warriors for each collector. No two ninja cats share the same destiny.</p>
    </div>

    <!-- Import config first as a module -->
    <script type="module">
        import { RPC_URL, CONTRACT_ADDRESS, NFT_ABI } from './js/config.js';

        // Make these available to the non-module script
        window.NFT_CONFIG = {
            RPC_URL,
            CONTRACT_ADDRESS,
            NFT_ABI
        };
    </script>

    <!-- NFT Carousel functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', async function () {
            // NFT Carousel setup
            async function setupNFTCarousel() {
                const carouselTrack = document.getElementById('nftCarousel');
                const dotsContainer = document.getElementById('carouselDots');
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                const autoPlayBtn = document.getElementById('autoPlayBtn');
                const counterEl = document.getElementById('carouselCounter');

                // Get contract config from window global set by module script
                const config = window.NFT_CONFIG;
                if (!config) {
                    console.error("Contract configuration not loaded");
                    carouselTrack.innerHTML = '<div class="carousel-item"><p>Error loading ninja cats</p></div>';
                    return;
                }

                try {
                    const provider = new ethers.JsonRpcProvider(config.RPC_URL);
                    const contract = new ethers.Contract(config.CONTRACT_ADDRESS, config.NFT_ABI, provider);

                    // Get total supply
                    const totalSupply = await contract.totalSupply();
                    const tokenCount = Number(totalSupply);

                    if (tokenCount <= 0) {
                        carouselTrack.innerHTML = `
                                <div class="carousel-item">
                                    <img src="assets/detailed_ninja_cat_64.png" alt="Placeholder" style="width: 150px; margin-bottom: 1rem;">
                                    <p>No ninja cats have been minted yet.<br>Be the first to summon a warrior!</p>
                                </div>`;
                        return;
                    }

                    // Update counter
                    counterEl.textContent = `${tokenCount} Ninja Cats Found`;

                    // We'll get up to 10 random cats to showcase
                    const catsToShow = Math.min(10, tokenCount);
                    const selectedTokens = [];

                    // If we have few cats, show them all
                    if (tokenCount <= 10) {
                        for (let i = 0; i < tokenCount; i++) {
                            selectedTokens.push(i);
                        }
                    } else {
                        // Otherwise select some random ones (with a bias toward newer ones)
                        // Always include the newest 3
                        for (let i = 0; i < 3 && i < tokenCount; i++) {
                            selectedTokens.push(tokenCount - 1 - i);
                        }

                        // Then add some random ones
                        while (selectedTokens.length < catsToShow) {
                            const randomIndex = Math.floor(Math.random() * tokenCount);
                            if (!selectedTokens.includes(randomIndex)) {
                                selectedTokens.push(randomIndex);
                            }
                        }
                    }

                    // Clear loading indicator
                    carouselTrack.innerHTML = '';

                    // Create a fallback image
                    const fallbackImage = "assets/detailed_ninja_cat_64.png";

                    // Create carousel items
                    for (let i = 0; i < selectedTokens.length; i++) {
                        const idx = selectedTokens[i];

                        // Create placeholder item while we load the data
                        const item = document.createElement('div');
                        item.className = 'carousel-item';
                        item.innerHTML = `
                                <div class="loading-spinner"></div>
                                <p>Loading Ninja Cat...</p>
                            `;
                        carouselTrack.appendChild(item);

                        // Create dot
                        const dot = document.createElement('div');
                        dot.className = 'carousel-dot' + (i === 0 ? ' active' : '');
                        dot.addEventListener('click', () => goToSlide(i));
                        dotsContainer.appendChild(dot);

                        try {
                            // Get token ID for this index
                            const tokenId = await contract.tokenByIndex(idx);

                            // Get token URI and metadata
                            const uri = await contract.tokenURI(tokenId);
                            let metadata;

                            if (uri.startsWith('ipfs://')) {
                                const ipfsHash = uri.replace('ipfs://', '');
                                const ipfsUrl = `https://ipfs.io/ipfs/${ipfsHash}`;
                                const response = await fetch(ipfsUrl);
                                metadata = await response.json();
                            } else {
                                const response = await fetch(uri);
                                metadata = await response.json();
                            }

                            // Update the carousel item with the fetched data
                            if (metadata && metadata.image) {
                                // Fix IPFS links
                                const imageUrl = metadata.image.startsWith('ipfs://')
                                    ? metadata.image.replace('ipfs://', 'https://ipfs.io/ipfs/')
                                    : metadata.image;

                                // Get traits for display
                                let breed = "Ninja Cat";
                                let element = "Shadow";
                                let weapon = "Katana";
                                let rank = "Novice";
                                let stance = "Attack";

                                if (metadata.attributes) {
                                    const breedAttr = metadata.attributes.find(a => a.trait_type === "Breed");
                                    const elementAttr = metadata.attributes.find(a => a.trait_type === "Element");
                                    const weaponAttr = metadata.attributes.find(a => a.trait_type === "Weapon");
                                    const rankAttr = metadata.attributes.find(a => a.trait_type === "Rank");
                                    const stanceAttr = metadata.attributes.find(a => a.trait_type === "Stance");

                                    if (breedAttr) breed = breedAttr.value;
                                    if (elementAttr) element = elementAttr.value;
                                    if (weaponAttr) weapon = weaponAttr.value;
                                    if (rankAttr) rank = rankAttr.value;
                                    if (stanceAttr) stance = stanceAttr.value;
                                }

                                // Get rarity if available
                                let rarity = "Common";
                                if (metadata.ninja_data && metadata.ninja_data.rarity) {
                                    rarity = metadata.ninja_data.rarity.tier;
                                }

                                // Get element color
                                let elementColor = "#8a65ff"; // Default shadow color

                                switch (element) {
                                    case "Fire": elementColor = "#ff6b5a"; break;
                                    case "Water": elementColor = "#5a9eff"; break;
                                    case "Earth": elementColor = "#5aff8d"; break;
                                    case "Wind": elementColor = "#c0c0c0"; break;
                                    case "Shadow": elementColor = "#8a65ff"; break;
                                    case "Lightning": elementColor = "#ffbb00"; break;
                                    case "Cosmic":
                                    case "Quantum":
                                    case "Astral": elementColor = "#ffd700"; break;
                                }

                                // Get special abilities
                                let abilities = [];
                                if (metadata.ninja_data && metadata.ninja_data.special_abilities) {
                                    abilities = metadata.ninja_data.special_abilities;
                                }

                                // Get backstory name if available
                                let ninjaName = metadata.name;
                                if (metadata.ninja_data && metadata.ninja_data.backstory && metadata.ninja_data.backstory.name) {
                                    ninjaName = metadata.ninja_data.backstory.name;
                                }

                                // Create enhanced carousel item with rich data
                                item.innerHTML = `
                                        <img src="${imageUrl}" alt="${metadata.name}" class="carousel-image"
                                             onerror="this.src='${fallbackImage}'">
                                        <div class="carousel-caption">
                                            <div style="font-weight: 600; margin-bottom: 0.2rem;">${metadata.name}</div>
                                            <div style="font-size: 0.85rem; margin-bottom: 0.5rem; color: ${elementColor};">
                                                ${element} Element • ${rank} <span style="opacity:0.7;">(${rarity})</span>
                                            </div>
                                            <div style="font-size: 0.8rem; color: #d0d0d0;">
                                                ${breed} • ${stance} Stance • ${weapon} Master
                                            </div>
                                            ${abilities.length > 0 ?
                                        `<div style="font-size: 0.75rem; color: #9e9e9e; margin-top: 0.5rem; font-style: italic;">
                                                    "${abilities[0].split(' - ')[0]}"
                                                </div>` : ''}
                                            ${metadata.ninja_data && metadata.ninja_data.backstory ?
                                        `<div style="font-size: 0.7rem; color: #7a7a7a; margin-top: 0.2rem;">
                                                    Known as "${metadata.ninja_data.backstory.name}"
                                                </div>` : ''}
                                        </div>
                                    `;

                                // Add click to view details
                                item.style.cursor = 'pointer';
                                item.addEventListener('click', () => {
                                    window.location.href = `kitty.html?id=${tokenId}`;
                                });
                            }
                        } catch (err) {
                            console.error("Error loading token:", err);
                            item.innerHTML = `
                                    <img src="${fallbackImage}" alt="Ninja Cat" class="carousel-image">
                                    <div class="carousel-caption">Mysterious Ninja Cat</div>
                                `;
                        }
                    }

                    // Set up carousel functionality
                    let currentSlide = 0;
                    const slides = document.querySelectorAll('.carousel-item');
                    const dots = document.querySelectorAll('.carousel-dot');

                    function goToSlide(n) {
                        currentSlide = n;
                        carouselTrack.style.transform = `translateX(-${currentSlide * 100}%)`;

                        // Update dots
                        dots.forEach((dot, i) => {
                            dot.classList.toggle('active', i === currentSlide);
                        });
                    }

                    // Add event listeners for navigation
                    prevBtn.addEventListener('click', () => {
                        currentSlide = (currentSlide - 1 + slides.length) % slides.length;
                        goToSlide(currentSlide);
                    });

                    nextBtn.addEventListener('click', () => {
                        currentSlide = (currentSlide + 1) % slides.length;
                        goToSlide(currentSlide);
                    });

                    // Auto-play functionality
                    let interval;
                    let isPlaying = false;

                    function toggleAutoPlay() {
                        if (isPlaying) {
                            clearInterval(interval);
                            autoPlayBtn.innerHTML = `
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                    </svg>
                                    Auto-Play`;
                        } else {
                            interval = setInterval(() => {
                                currentSlide = (currentSlide + 1) % slides.length;
                                goToSlide(currentSlide);
                            }, 4000);
                            autoPlayBtn.innerHTML = `
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect x="6" y="4" width="4" height="16"></rect>
                                        <rect x="14" y="4" width="4" height="16"></rect>
                                    </svg>
                                    Pause`;
                        }
                        isPlaying = !isPlaying;
                    }

                    // Start autoplay by default
                    toggleAutoPlay();

                    // Add click handler for autoplay button
                    autoPlayBtn.addEventListener('click', toggleAutoPlay);

                    // Pause on hover
                    carouselTrack.addEventListener('mouseenter', () => {
                        if (isPlaying) {
                            clearInterval(interval);
                        }
                    });

                    carouselTrack.addEventListener('mouseleave', () => {
                        if (isPlaying) {
                            clearInterval(interval);
                            interval = setInterval(() => {
                                currentSlide = (currentSlide + 1) % slides.length;
                                goToSlide(currentSlide);
                            }, 4000);
                        }
                    });

                } catch (error) {
                    console.error("Error setting up NFT carousel:", error);
                    carouselTrack.innerHTML = `
                            <div class="carousel-item">
                                <img src="assets/detailed_ninja_cat_64.png" alt="Placeholder" style="width: 150px; margin-bottom: 1rem;">
                                <p>Error loading ninja cats.<br>The ancient scrolls are currently unreadable.</p>
                            </div>`;
                }
            }

            // Initialize carousel
            setupNFTCarousel();
        });
    </script>

    <!-- Load wallet connection script -->
    <script type="module" src="js/connect-only.js"></script>

    <!-- Include the footer -->
    <footer id="footer"></footer>
    <script src="js/footer.js"></script>
</body>
</html>